<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Velocite Systems Protected Point to Point Solution: p3ksecondary.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>p3ksecondary.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>Protected Point to Point product secondary main functions header file</h3>
<p>
Copyright (C) Velocite 2010 
<p>
<code>#include &quot;<a class="el" href="p3kbase_8h-source.html">p3kbase.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="p3knet_8h-source.html">p3knet.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for p3ksecondary.h:</div>
<div class="dynsection">
<p><center><img src="p3ksecondary_8h__incl.png" border="0" usemap="#p3ksecondary.h_map" alt=""></center>
<map name="p3ksecondary.h_map">
<area shape="rect" href="p3kbase_8h.html" title="p3kbase.h" alt="" coords="737,239,825,265"><area shape="rect" href="p3knet_8h.html" title="p3knet.h" alt="" coords="781,84,859,111"><area shape="rect" href="p3linux_8h.html" title="p3linux.h" alt="" coords="800,316,877,343"><area shape="rect" href="p3ksession_8h.html" title="p3ksession.h" alt="" coords="832,161,936,188"><area shape="rect" href="p3kcrypto_8h.html" title="p3kcrypto.h" alt="" coords="849,239,945,265"></map>
</div>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="p3ksecondary_8h__dep__incl.png" border="0" usemap="#p3ksecondary.hdep_map" alt=""></center>
<map name="p3ksecondary.hdep_map">
<area shape="rect" href="p3kprimaryplus_8h.html" title="p3kprimaryplus.h" alt="" coords="5,82,125,106"><area shape="rect" href="p3ksec__session_8c.html" title="p3ksec_session.c" alt="" coords="149,82,275,106"><area shape="rect" href="p3ksecondary_8c.html" title="p3ksecondary.c" alt="" coords="299,82,411,106"><area shape="rect" href="p3kprimaryplus_8c.html" title="p3kprimaryplus.c" alt="" coords="5,156,125,180"></map>
</div>

<p>
<a href="p3ksecondary_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3sec__main.html">_p3sec_main</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksecondary_8h.html#817ec8cdc6734532619ee3794eac8c60">p3SEC_FLG1</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3sec__main.html">_p3sec_main</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksecondary_8h.html#45b5eb13a89dcbdfeb47fa4f125ecb4e">p3sec_main</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksecondary_8h.html#47e0b2427f78793537acd495a856517d">init_secondary</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksecondary_8h.html#15ca37bcc4730f5931238ec7bccf0ff0">parse_p3data</a> (unsigned char *buffer, int size)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3sec__main.html">p3sec_main</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksecondary_8h.html#e4baf3a9549eb15921bb3cc1797200f2">secmain</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="817ec8cdc6734532619ee3794eac8c60"></a><!-- doxytag: member="p3ksecondary.h::p3SEC_FLG1" ref="817ec8cdc6734532619ee3794eac8c60" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3SEC_FLG1&nbsp;&nbsp;&nbsp;0x00000001          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="45b5eb13a89dcbdfeb47fa4f125ecb4e"></a><!-- doxytag: member="p3ksecondary.h::p3sec_main" ref="45b5eb13a89dcbdfeb47fa4f125ecb4e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3sec__main.html">_p3sec_main</a> <a class="el" href="struct__p3sec__main.html">p3sec_main</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="47e0b2427f78793537acd495a856517d"></a><!-- doxytag: member="p3ksecondary.h::init_secondary" ref="47e0b2427f78793537acd495a856517d" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_secondary           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>init_p3secondary</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Initialize the P3 Primary module by creating the basic structures for handling P3 secondary connections.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>None</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3knet_8c-source.html#l00060">init_p3net()</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3base_8h-source.html#l00185">p3calloc</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, and <a class="el" href="p3base_8h-source.html#l00046">p3MSG_CRIT</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksecondary_8h_47e0b2427f78793537acd495a856517d_cgraph.png" border="0" usemap="#p3ksecondary_8h_47e0b2427f78793537acd495a856517d_cgraph_map" alt=""></center>
<map name="p3ksecondary_8h_47e0b2427f78793537acd495a856517d_cgraph_map">
<area shape="rect" href="p3knet_8c.html#ebcb19f32b96fdb0c580e57088828b4a" title="init_p3net" alt="" coords="169,5,252,32"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="303,31,385,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="15ca37bcc4730f5931238ec7bccf0ff0"></a><!-- doxytag: member="p3ksecondary.h::parse_p3data" ref="15ca37bcc4730f5931238ec7bccf0ff0" args="(unsigned char *buffer, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_p3data           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>parse_p3data</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Parse data sent from the P3 user space application in an ioctl command.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>buffer: The data to be parsed</li><li>size: The size of the data buffer</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Critical error</li><li>&gt;0 = Non-critical error</li></ul>
</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Function:</b></dt><dd>parse_p3data</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Parse the P3 Secondary configuration file.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>buffer: The data to be parsed</li><li>size: The size of the data buffer</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error</li><li>&gt;0 = Config does not exist, use defaults </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="struct__p3prihostcfg.html#dec9d1bd5e21ed9cc4de7ec036b26628">_p3prihostcfg::addr</a>, <a class="el" href="struct__p3secondarycfg.html#f5df3d567d304f7537228cc2cfd823c8">_p3secondarycfg::addr</a>, <a class="el" href="struct__p3sec__main.html#10d3cf16754fad672cb6d319559ec4de">_p3sec_main::addr</a>, <a class="el" href="struct__p3newsession.html#9200d666ae9eb9d8752bb7a6c2494a11">_p3newsession::addr</a>, <a class="el" href="struct__p3sechostcfg.html#59fceb493485d9dda556ce1cbef1b0f3">_p3sechostcfg::addr</a>, <a class="el" href="struct__p3host.html#1d30157fd8630192bcadb18c25dacd9f">_p3host::addr</a>, <a class="el" href="struct__p3primarycfg.html#8039422f27d87c467ce8966807ce9499">_p3primarycfg::addr</a>, <a class="el" href="struct__p3pri__main.html#e1477d229d77391fa692d73c6010d9ab">_p3pri_main::addr</a>, <a class="el" href="p3share_8h-source.html#l00059">_p3primarycfg::array_size</a>, <a class="el" href="p3kprimary_8h-source.html#l00040">_p3pri_main::array_size</a>, <a class="el" href="p3knet_8c-source.html#l00119">build_p3table()</a>, <a class="el" href="p3share_8h-source.html#l00131">_p3sechostcfg::citime</a>, <a class="el" href="p3kcrypto_8h-source.html#l00099">_p3keymgmt::cnewkey</a>, <a class="el" href="p3share_8h-source.html#l00175">_p3newsession::ctlkey</a>, <a class="el" href="p3share_8h-source.html#l00174">_p3newsession::datakey</a>, <a class="el" href="p3share_8h-source.html#l00130">_p3sechostcfg::ditime</a>, <a class="el" href="p3kcrypto_8h-source.html#l00098">_p3keymgmt::dnewkey</a>, <a class="el" href="p3share_8h-source.html#l00106">_p3prihostcfg::flag</a>, <a class="el" href="p3share_8h-source.html#l00087">_p3secondarycfg::flag</a>, <a class="el" href="p3secondary_8h-source.html#l00043">_p3sec_main::flag</a>, <a class="el" href="p3share_8h-source.html#l00172">_p3newsession::flag</a>, <a class="el" href="p3ksession_8h-source.html#l00141">_p3session::flag</a>, <a class="el" href="p3net_8h-source.html#l00046">_p3host::flag</a>, <a class="el" href="p3share_8h-source.html#l00132">_p3sechostcfg::flag</a>, <a class="el" href="p3share_8h-source.html#l00071">_p3primarycfg::flag</a>, <a class="el" href="p3primary_8h-source.html#l00042">_p3pri_main::flag</a>, <a class="el" href="p3share_8h-source.html#l00128">_p3sechostcfg::hb_fail</a>, <a class="el" href="p3ksession_8h-source.html#l00083">_p3host::hb_fail</a>, <a class="el" href="p3share_8h-source.html#l00127">_p3sechostcfg::hb_wait</a>, <a class="el" href="p3ksession_8h-source.html#l00082">_p3host::hb_wait</a>, <a class="el" href="p3ksession_8h-source.html#l00076">_p3host::hlist</a>, <a class="el" href="p3knet_8h-source.html#l00077">_p3net::host</a>, <a class="el" href="p3ksession_8h-source.html#l00105">_p3session::host</a>, <a class="el" href="p3ksession_8c-source.html#l00038">init_session()</a>, <a class="el" href="p3crypto_8h-source.html#l00040">_p3key::key</a>, <a class="el" href="p3ksession_8h-source.html#l00106">_p3session::keymgmt</a>, <a class="el" href="p3share_8h-source.html#l00155">_p3subnetcfg::mask</a>, <a class="el" href="struct__p3net.html#be25dc9f35a0bfab971f90d4d700edc8">_p3net::mask</a>, <a class="el" href="struct__p3subnetcfg.html#458e7792eabe62f86124729715baf592">_p3subnetcfg::net</a>, <a class="el" href="struct__p3net.html#31bd369b936ae785a5b03cb8f6d9ba0a">_p3net::net</a>, <a class="el" href="p3share_8h-source.html#l00035">newsession</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3kcrypto_8c-source.html#l00054">p3_get_key_size()</a>, <a class="el" href="p3kcrypto_8c-source.html#l00205">p3_init_crypto()</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3base_8h-source.html#l00185">p3calloc</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3knet_8c-source.html#l00033">p3hosts</a>, <a class="el" href="p3net_8h-source.html#l00048">p3HST_IPV4</a>, <a class="el" href="p3net_8h-source.html#l00049">p3HST_IPV6</a>, <a class="el" href="p3net_8h-source.html#l00052">p3HST_KTSHF</a>, <a class="el" href="p3crypto_8h-source.html#l00021">p3KTYPE_AES128</a>, <a class="el" href="p3base_8h-source.html#l00046">p3MSG_CRIT</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, <a class="el" href="p3base_8h-source.html#l00048">p3MSG_WARN</a>, <a class="el" href="p3ksession_8h-source.html#l00143">p3PSS_ACT</a>, <a class="el" href="p3ksession_8h-source.html#l00142">p3PSS_KTYPE</a>, <a class="el" href="p3ksession_8h-source.html#l00136">p3SESSION_HDR4</a>, <a class="el" href="p3ksession_8h-source.html#l00137">p3SESSION_HDR6</a>, <a class="el" href="p3ksession_8h-source.html#l00151">p3SESSION_SIZE</a>, <a class="el" href="p3share_8h-source.html#l00105">_p3prihostcfg::port</a>, <a class="el" href="p3ksession_8h-source.html#l00084">_p3host::port</a>, <a class="el" href="p3share_8h-source.html#l00057">_p3primarycfg::port</a>, <a class="el" href="p3kprimary_8h-source.html#l00047">_p3pri_main::port</a>, <a class="el" href="p3share_8h-source.html#l00035">primarycfg</a>, <a class="el" href="p3share_8h-source.html#l00035">primaryhostcfg</a>, <a class="el" href="p3share_8h-source.html#l00129">_p3sechostcfg::rk_wait</a>, <a class="el" href="p3share_8h-source.html#l00035">secondarycfg</a>, <a class="el" href="p3share_8h-source.html#l00035">secondaryhostcfg</a>, <a class="el" href="p3ksession_8h-source.html#l00077">_p3host::session</a>, <a class="el" href="p3share_8h-source.html#l00104">_p3prihostcfg::subnetsz</a>, <a class="el" href="p3share_8h-source.html#l00126">_p3sechostcfg::subnetsz</a>, <a class="el" href="p3share_8h-source.html#l00100">_p3prihostcfg::v4</a>, <a class="el" href="p3share_8h-source.html#l00084">_p3secondarycfg::v4</a>, <a class="el" href="p3ksecondary_8h-source.html#l00037">_p3sec_main::v4</a>, <a class="el" href="p3share_8h-source.html#l00169">_p3newsession::v4</a>, <a class="el" href="p3share_8h-source.html#l00152">_p3subnetcfg::v4</a>, <a class="el" href="p3net_8h-source.html#l00096">_p3net::v4</a>, <a class="el" href="p3share_8h-source.html#l00122">_p3sechostcfg::v4</a>, <a class="el" href="p3net_8h-source.html#l00037">_p3host::v4</a>, <a class="el" href="p3share_8h-source.html#l00054">_p3primarycfg::v4</a>, <a class="el" href="p3kprimary_8h-source.html#l00044">_p3pri_main::v4</a>, <a class="el" href="p3share_8h-source.html#l00101">_p3prihostcfg::v6</a>, <a class="el" href="p3share_8h-source.html#l00085">_p3secondarycfg::v6</a>, <a class="el" href="p3ksecondary_8h-source.html#l00038">_p3sec_main::v6</a>, <a class="el" href="p3share_8h-source.html#l00170">_p3newsession::v6</a>, <a class="el" href="p3share_8h-source.html#l00153">_p3subnetcfg::v6</a>, <a class="el" href="p3net_8h-source.html#l00097">_p3net::v6</a>, <a class="el" href="p3share_8h-source.html#l00123">_p3sechostcfg::v6</a>, <a class="el" href="p3net_8h-source.html#l00038">_p3host::v6</a>, <a class="el" href="p3share_8h-source.html#l00055">_p3primarycfg::v6</a>, and <a class="el" href="p3kprimary_8h-source.html#l00045">_p3pri_main::v6</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksecondary_8h_15ca37bcc4730f5931238ec7bccf0ff0_cgraph.png" border="0" usemap="#p3ksecondary_8h_15ca37bcc4730f5931238ec7bccf0ff0_cgraph_map" alt=""></center>
<map name="p3ksecondary_8h_15ca37bcc4730f5931238ec7bccf0ff0_cgraph_map">
<area shape="rect" href="p3knet_8c.html#477c7725aa7c5d922a3e6f4cf59c419f" title="build_p3table" alt="" coords="341,5,448,32"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="744,56,827,83"><area shape="rect" href="p3ksession_8c.html#67c0368da866a1d40d64c5c5f62c0da5" title="init_session" alt="" coords="179,107,275,133"><area shape="rect" href="p3kcrypto_8c.html#b4cab0205447c3702dd6d0f6ecfd19b2" title="p3_get_key_size" alt="" coords="164,157,289,184"><area shape="rect" href="p3kcrypto_8c.html#2fff99ba7e77678db3154d219a8014d0" title="p3_init_crypto" alt="" coords="172,208,281,235"><area shape="rect" href="aes_8c.html#907a0fa24742e214cf5745ef2c4c2d26" title="CreateAESCtx" alt="" coords="339,196,451,223"><area shape="rect" href="aes_8h.html#2d6be417e64bdeddfc5c0c035fb6d176" title="AESALGO_makeAesKey" alt="" coords="500,189,671,216"><area shape="rect" href="aesalgo_8c.html#94c062eb10035b9a2d630b4d7c1a5fc7" title="aesKeySetupDec" alt="" coords="721,164,849,191"><area shape="rect" href="aesalgo_8c.html#fd719d98c97fc2800b503dfe71eaedef" title="aesKeySetupEnc" alt="" coords="899,189,1027,216"></map>
</div>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="e4baf3a9549eb15921bb3cc1797200f2"></a><!-- doxytag: member="p3ksecondary.h::secmain" ref="e4baf3a9549eb15921bb3cc1797200f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3sec__main.html">p3sec_main</a>* <a class="el" href="p3ksecondary_8h.html#e4baf3a9549eb15921bb3cc1797200f2">secmain</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The main secondary structure 
<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00633">p3_lookup()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Sep 24 10:44:30 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
