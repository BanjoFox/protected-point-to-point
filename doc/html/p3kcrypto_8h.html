<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Velocite Systems Protected Point to Point Solution: p3kcrypto.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>p3kcrypto.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>Protected Point to Point key server header file</h3>
<p>
Copyright (C) Velocite 2010 
<p>
<code>#include &quot;<a class="el" href="p3linux_8h-source.html">p3linux.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for p3kcrypto.h:</div>
<div class="dynsection">
<p><center><img src="p3kcrypto_8h__incl.png" border="0" usemap="#p3kcrypto.h_map" alt=""></center>
<map name="p3kcrypto.h_map">
<area shape="rect" href="p3linux_8h.html" title="p3linux.h" alt="" coords="800,84,877,111"></map>
</div>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="p3kcrypto_8h__dep__incl.png" border="0" usemap="#p3kcrypto.hdep_map" alt=""></center>
<map name="p3kcrypto.hdep_map">
<area shape="rect" href="p3kcrypto_8c.html" title="p3kcrypto.c" alt="" coords="379,84,475,111"><area shape="rect" href="p3ksession_8h.html" title="p3ksession.h" alt="" coords="499,84,603,111"><area shape="rect" href="p3kprimary_8c.html" title="p3kprimary.c" alt="" coords="720,316,821,343"><area shape="rect" href="p3knet_8h.html" title="p3knet.h" alt="" coords="429,161,507,188"><area shape="rect" href="p3kpri__session_8c.html" title="p3kpri_session.c" alt="" coords="569,316,695,343"><area shape="rect" href="p3ksec__session_8c.html" title="p3ksec_session.c" alt="" coords="5,316,136,343"><area shape="rect" href="p3knet_8c.html" title="p3knet.c" alt="" coords="481,239,556,265"><area shape="rect" href="p3kprimary_8h.html" title="p3kprimary.h" alt="" coords="580,239,684,265"><area shape="rect" href="p3ksecondary_8h.html" title="p3ksecondary.h" alt="" coords="108,239,228,265"><area shape="rect" href="p3ksession_8c.html" title="p3ksession.c" alt="" coords="252,239,356,265"><area shape="rect" href="p3linux_8c.html" title="p3linux.c" alt="" coords="380,239,457,265"><area shape="rect" href="p3kprimaryplus_8h.html" title="p3kprimaryplus.h" alt="" coords="360,316,491,343"><area shape="rect" href="p3kprimaryplus_8c.html" title="p3kprimaryplus.c" alt="" coords="360,393,491,420"><area shape="rect" href="p3ksecondary_8c.html" title="p3ksecondary.c" alt="" coords="160,316,280,343"></map>
</div>

<p>
<a href="p3kcrypto_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3key__serv.html">_p3key_serv</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3key__mgr.html">_p3key_mgr</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3key.html">_p3key</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3keymgmt.html">_p3keymgmt</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#5e218cf082b038523f677bab9b0ff5ca">p3KTYPE_AES128</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#43e96f5ff430b56b883cc845f6c80aa1">p3KSIZE_AES128</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#7ebc574440c6e3bceb3310b0961a02cf">p3KTYPE_AES256</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#e88a9f5adc845808aec753b6a2131843">p3KSIZE_AES256</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#3afd1aff6f081eb983013f740c97bad7">p3MAX_KSIZE</a>&nbsp;&nbsp;&nbsp;p3KSIZE_AES256</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#5d938995d3124d71fbfef03ee2b3e93c">p3CRYPTO_ALIGN</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#d858cb6b7f1d37add83e212ec0b22421">p3DATENC1</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#c64877ad255c49a8f763adb93c14a006">p3DATDEC1</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#e824aaf3f809b32e3e33bd47d5506427">p3DATENC0</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#338ee6a40b1762b053746e3082c0abd5">p3DATDEC0</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#9444d48a0e37630c9e3c5db3de6f267c">p3CTLENC1</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#850bebbc6f870b3b47c24f3987131743">p3CTLDEC1</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#2cdb302757b771ec07d4cd45f68d8bb1">p3CTLENC0</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#992b7539af45c2005df63515239a759b">p3CTLDEC0</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#ad9382679924b23d2670698d0286af71">p3KMG_KEYS</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3key__serv.html">_p3key_serv</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#9dcda55232a7b25650a6ea818e09861e">p3key_serv</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3key__mgr.html">_p3key_mgr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#40b58b6736ede220f30cada26da43190">p3key_mgr</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3key.html">_p3key</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#eff4372f5ef87935d45de2712e704bce">p3key</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3keymgmt.html">_p3keymgmt</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#9f30ed83191e7836fbc56413438a9220">p3keymgmt</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#b4cab0205447c3702dd6d0f6ecfd19b2">p3_get_key_size</a> (int type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#8d9703c5e72d2adf16d562796964e374">p3_get_key</a> (<a class="el" href="struct__p3key.html">p3key</a> *key, <a class="el" href="struct__p3key__mgr.html">p3key_mgr</a> *key_mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3key.html">p3key</a> **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#a8121a20f39254747583f05a2c1cdd23">p3_get_key_array</a> (int size, int number, <a class="el" href="struct__p3key__mgr.html">p3key_mgr</a> *key_mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#2fff99ba7e77678db3154d219a8014d0">p3_init_crypto</a> (<a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *keys)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#2e8e3ba5d89461cd203f9347c9692f3c">p3_rekey</a> (<a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *keys)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#e807e42de382b4967dcf61a94abf1d63">p3_encrypt</a> (unsigned char *buffer, int size, unsigned int id, int key, <a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *keys)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kcrypto_8h.html#3285d40d28100b2efe0ca06b8d00b2f8">p3_decrypt</a> (unsigned char *buffer, int size, unsigned int id, int key, <a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *keys)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="5e218cf082b038523f677bab9b0ff5ca"></a><!-- doxytag: member="p3kcrypto.h::p3KTYPE_AES128" ref="5e218cf082b038523f677bab9b0ff5ca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KTYPE_AES128&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="43e96f5ff430b56b883cc845f6c80aa1"></a><!-- doxytag: member="p3kcrypto.h::p3KSIZE_AES128" ref="43e96f5ff430b56b883cc845f6c80aa1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KSIZE_AES128&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="7ebc574440c6e3bceb3310b0961a02cf"></a><!-- doxytag: member="p3kcrypto.h::p3KTYPE_AES256" ref="7ebc574440c6e3bceb3310b0961a02cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KTYPE_AES256&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="e88a9f5adc845808aec753b6a2131843"></a><!-- doxytag: member="p3kcrypto.h::p3KSIZE_AES256" ref="e88a9f5adc845808aec753b6a2131843" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KSIZE_AES256&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="3afd1aff6f081eb983013f740c97bad7"></a><!-- doxytag: member="p3kcrypto.h::p3MAX_KSIZE" ref="3afd1aff6f081eb983013f740c97bad7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3MAX_KSIZE&nbsp;&nbsp;&nbsp;p3KSIZE_AES256          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5d938995d3124d71fbfef03ee2b3e93c"></a><!-- doxytag: member="p3kcrypto.h::p3CRYPTO_ALIGN" ref="5d938995d3124d71fbfef03ee2b3e93c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CRYPTO_ALIGN&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d858cb6b7f1d37add83e212ec0b22421"></a><!-- doxytag: member="p3kcrypto.h::p3DATENC1" ref="d858cb6b7f1d37add83e212ec0b22421" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3DATENC1&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00392">p3_encrypt()</a>, <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c64877ad255c49a8f763adb93c14a006"></a><!-- doxytag: member="p3kcrypto.h::p3DATDEC1" ref="c64877ad255c49a8f763adb93c14a006" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3DATDEC1&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00466">p3_decrypt()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e824aaf3f809b32e3e33bd47d5506427"></a><!-- doxytag: member="p3kcrypto.h::p3DATENC0" ref="e824aaf3f809b32e3e33bd47d5506427" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3DATENC0&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00392">p3_encrypt()</a>.</p>

</div>
</div><p>
<a class="anchor" name="338ee6a40b1762b053746e3082c0abd5"></a><!-- doxytag: member="p3kcrypto.h::p3DATDEC0" ref="338ee6a40b1762b053746e3082c0abd5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3DATDEC0&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00466">p3_decrypt()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9444d48a0e37630c9e3c5db3de6f267c"></a><!-- doxytag: member="p3kcrypto.h::p3CTLENC1" ref="9444d48a0e37630c9e3c5db3de6f267c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CTLENC1&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00392">p3_encrypt()</a>, and <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>.</p>

</div>
</div><p>
<a class="anchor" name="850bebbc6f870b3b47c24f3987131743"></a><!-- doxytag: member="p3kcrypto.h::p3CTLDEC1" ref="850bebbc6f870b3b47c24f3987131743" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CTLDEC1&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00466">p3_decrypt()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2cdb302757b771ec07d4cd45f68d8bb1"></a><!-- doxytag: member="p3kcrypto.h::p3CTLENC0" ref="2cdb302757b771ec07d4cd45f68d8bb1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CTLENC0&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00392">p3_encrypt()</a>.</p>

</div>
</div><p>
<a class="anchor" name="992b7539af45c2005df63515239a759b"></a><!-- doxytag: member="p3kcrypto.h::p3CTLDEC0" ref="992b7539af45c2005df63515239a759b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CTLDEC0&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00466">p3_decrypt()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ad9382679924b23d2670698d0286af71"></a><!-- doxytag: member="p3kcrypto.h::p3KMG_KEYS" ref="ad9382679924b23d2670698d0286af71" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KMG_KEYS&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="9dcda55232a7b25650a6ea818e09861e"></a><!-- doxytag: member="p3kcrypto.h::p3key_serv" ref="9dcda55232a7b25650a6ea818e09861e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3key__serv.html">_p3key_serv</a> <a class="el" href="struct__p3key__serv.html">p3key_serv</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="40b58b6736ede220f30cada26da43190"></a><!-- doxytag: member="p3kcrypto.h::p3key_mgr" ref="40b58b6736ede220f30cada26da43190" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3key__mgr.html">_p3key_mgr</a> <a class="el" href="struct__p3key__mgr.html">p3key_mgr</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="eff4372f5ef87935d45de2712e704bce"></a><!-- doxytag: member="p3kcrypto.h::p3key" ref="eff4372f5ef87935d45de2712e704bce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3key.html">_p3key</a> <a class="el" href="struct__p3key.html">p3key</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="9f30ed83191e7836fbc56413438a9220"></a><!-- doxytag: member="p3kcrypto.h::p3keymgmt" ref="9f30ed83191e7836fbc56413438a9220" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3keymgmt.html">_p3keymgmt</a> <a class="el" href="struct__p3keymgmt.html">p3keymgmt</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="b4cab0205447c3702dd6d0f6ecfd19b2"></a><!-- doxytag: member="p3kcrypto.h::p3_get_key_size" ref="b4cab0205447c3702dd6d0f6ecfd19b2" args="(int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int p3_get_key_size           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>p3_get_key_size</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Get the size of an encryption key.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: The type of the encryption algorithm.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int:<ul>
<li>0: Key size</li><li>&lt;0: Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3crypto_8h-source.html#l00022">p3KSIZE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00024">p3KSIZE_AES256</a>, <a class="el" href="p3crypto_8h-source.html#l00021">p3KTYPE_AES128</a>, and <a class="el" href="p3crypto_8h-source.html#l00023">p3KTYPE_AES256</a>.</p>

<p>Referenced by <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8d9703c5e72d2adf16d562796964e374"></a><!-- doxytag: member="p3kcrypto.h::p3_get_key" ref="8d9703c5e72d2adf16d562796964e374" args="(p3key *key, p3key_mgr *key_mgr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int p3_get_key           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3key.html">p3key</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3key__mgr.html">p3key_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>key_mgr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>p3_get_key</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Get an encryption key from the Ramdisk buffer.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>key: The P3 key structure. The flag in the structure contains information about the key, such as its type (size). The new key is returned in this structure.</li><li>key_mgr: The P3 key manager structure that maintains information about the circular buffer of keys.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0: OK</li><li>&lt;0: Error</li><li>&gt;0: Key unavailable, try later </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3pri__key__server_8h-source.html#l00032">_p3key_serv::cbuf_sz</a>, <a class="el" href="p3pri__key__server_8h-source.html#l00030">_p3key_serv::head</a>, <a class="el" href="p3crypto_8h-source.html#l00040">_p3key::key</a>, <a class="el" href="p3kcrypto_8h-source.html#l00064">_p3key_mgr::key_serv</a>, <a class="el" href="p3pri__key__server_8c-source.html#l00025">key_serv</a>, <a class="el" href="p3kcrypto_8h-source.html#l00065">_p3key_mgr::lock</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>, <a class="el" href="p3crypto_8h-source.html#l00041">_p3key::size</a>, and <a class="el" href="p3pri__key__server_8h-source.html#l00031">_p3key_serv::tail</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3kcrypto_8h_8d9703c5e72d2adf16d562796964e374_cgraph.png" border="0" usemap="#p3kcrypto_8h_8d9703c5e72d2adf16d562796964e374_cgraph_map" alt=""></center>
<map name="p3kcrypto_8h_8d9703c5e72d2adf16d562796964e374_cgraph_map">
<area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="151,5,233,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="a8121a20f39254747583f05a2c1cdd23"></a><!-- doxytag: member="p3kcrypto.h::p3_get_key_array" ref="a8121a20f39254747583f05a2c1cdd23" args="(int size, int number, p3key_mgr *key_mgr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3key.html">p3key</a>** p3_get_key_array           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3key__mgr.html">p3key_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>key_mgr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>p3_get_key_array</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Get an array of encryption keys. All keys in the array are true random numbers.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>size: The size, in bytes, of the key to be retrieved</li><li>number: The number of keys in the array</li><li>key_mgr: The P3 key server structure that maintains information about the circular buffer of keys.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>p3key**: The array containing the keys. If there is an error, NULL is returned. </li></ul>
</dd></dl>

<p>References <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>.</p>

</div>
</div><p>
<a class="anchor" name="2fff99ba7e77678db3154d219a8014d0"></a><!-- doxytag: member="p3kcrypto.h::p3_init_crypto" ref="2fff99ba7e77678db3154d219a8014d0" args="(p3keymgmt *keys)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int p3_init_crypto           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *&nbsp;</td>
          <td class="paramname"> <em>keys</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>p3_init_crypto</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Initialize the keys for a session by creating the crypto context for each key.</dd></dl>
<em>The value of the data and control new key fields will be used for initializing the contexts.</em><p>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>keys: The session key managment structure.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0: OK</li><li>&lt;0: Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3kcrypto_8h-source.html#l00099">_p3keymgmt::cnewkey</a>, <a class="el" href="aes_8c-source.html#l00041">CreateAESCtx()</a>, <a class="el" href="p3kcrypto_8c-source.html#l00036">crypto_lock</a>, <a class="el" href="p3kcrypto_8h-source.html#l00097">_p3keymgmt::ctldec1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00096">_p3keymgmt::ctlenc1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00093">_p3keymgmt::datdec1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00092">_p3keymgmt::datenc1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00098">_p3keymgmt::dnewkey</a>, <a class="el" href="p3profile_8c-source.html#l00026">FALSE</a>, <a class="el" href="p3kcrypto_8c-source.html#l00037">initlock</a>, <a class="el" href="p3crypto_8h-source.html#l00040">_p3key::key</a>, <a class="el" href="p3kcrypto_8c-source.html#l00037">lockheld</a>, <a class="el" href="hw__accel_8h-source.html#l00044">MOC_SYM</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3linux_8h-source.html#l00069">p3lock_init</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>, <a class="el" href="p3crypto_8h-source.html#l00041">_p3key::size</a>, and <a class="el" href="p3profile_8c-source.html#l00025">TRUE</a>.</p>

<p>Referenced by <a class="el" href="p3kcrypto_8c-source.html#l00290">p3_rekey()</a>, and <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3kcrypto_8h_2fff99ba7e77678db3154d219a8014d0_cgraph.png" border="0" usemap="#p3kcrypto_8h_2fff99ba7e77678db3154d219a8014d0_cgraph_map" alt=""></center>
<map name="p3kcrypto_8h_2fff99ba7e77678db3154d219a8014d0_cgraph_map">
<area shape="rect" href="aes_8c.html#907a0fa24742e214cf5745ef2c4c2d26" title="CreateAESCtx" alt="" coords="165,56,277,83"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="571,107,653,133"><area shape="rect" href="aes_8h.html#2d6be417e64bdeddfc5c0c035fb6d176" title="AESALGO_makeAesKey" alt="" coords="327,56,497,83"><area shape="rect" href="aesalgo_8c.html#94c062eb10035b9a2d630b4d7c1a5fc7" title="aesKeySetupDec" alt="" coords="548,5,676,32"><area shape="rect" href="aesalgo_8c.html#fd719d98c97fc2800b503dfe71eaedef" title="aesKeySetupEnc" alt="" coords="725,31,853,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2e8e3ba5d89461cd203f9347c9692f3c"></a><!-- doxytag: member="p3kcrypto.h::p3_rekey" ref="2e8e3ba5d89461cd203f9347c9692f3c" args="(p3keymgmt *keys)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int p3_rekey           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *&nbsp;</td>
          <td class="paramname"> <em>keys</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>p3_rekey</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Update the key management structure after a P3 Rekey control message has been completed. This consists of releasing the oldest keys, copying the current keys to the previous key fields, and initializing the new keys.</dd></dl>
<em>Note that the data and control new key fields must contain the new keys to be used.</em><p>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>keys: The session key managment structure.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0: OK</li><li>&lt;0: Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3kcrypto_8h-source.html#l00099">_p3keymgmt::cnewkey</a>, <a class="el" href="p3kcrypto_8c-source.html#l00036">crypto_lock</a>, <a class="el" href="p3kcrypto_8h-source.html#l00095">_p3keymgmt::ctldec0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00097">_p3keymgmt::ctldec1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00094">_p3keymgmt::ctlenc0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00096">_p3keymgmt::ctlenc1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00091">_p3keymgmt::datdec0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00093">_p3keymgmt::datdec1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00090">_p3keymgmt::datenc0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00092">_p3keymgmt::datenc1</a>, <a class="el" href="aes_8c-source.html#l00064">DeleteAESCtx()</a>, <a class="el" href="p3kcrypto_8h-source.html#l00098">_p3keymgmt::dnewkey</a>, <a class="el" href="p3crypto_8h-source.html#l00040">_p3key::key</a>, <a class="el" href="p3kcrypto_8c-source.html#l00037">lockheld</a>, <a class="el" href="hw__accel_8h-source.html#l00044">MOC_SYM</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3kcrypto_8c-source.html#l00205">p3_init_crypto()</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, and <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>.</p>

<p>Referenced by <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3kcrypto_8h_2e8e3ba5d89461cd203f9347c9692f3c_cgraph.png" border="0" usemap="#p3kcrypto_8h_2e8e3ba5d89461cd203f9347c9692f3c_cgraph_map" alt=""></center>
<map name="p3kcrypto_8h_2e8e3ba5d89461cd203f9347c9692f3c_cgraph_map">
<area shape="rect" href="aes_8c.html#e6725f8404860044aeb3bb02a46006b4" title="DeleteAESCtx" alt="" coords="135,56,244,83"><area shape="rect" href="p3kcrypto_8c.html#2fff99ba7e77678db3154d219a8014d0" title="p3_init_crypto" alt="" coords="135,107,244,133"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="699,107,781,133"><area shape="rect" href="aes_8c.html#907a0fa24742e214cf5745ef2c4c2d26" title="CreateAESCtx" alt="" coords="293,56,405,83"><area shape="rect" href="aes_8h.html#2d6be417e64bdeddfc5c0c035fb6d176" title="AESALGO_makeAesKey" alt="" coords="455,56,625,83"><area shape="rect" href="aesalgo_8c.html#94c062eb10035b9a2d630b4d7c1a5fc7" title="aesKeySetupDec" alt="" coords="676,5,804,32"><area shape="rect" href="aesalgo_8c.html#fd719d98c97fc2800b503dfe71eaedef" title="aesKeySetupEnc" alt="" coords="853,31,981,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="e807e42de382b4967dcf61a94abf1d63"></a><!-- doxytag: member="p3kcrypto.h::p3_encrypt" ref="e807e42de382b4967dcf61a94abf1d63" args="(unsigned char *buffer, int size, unsigned int id, int key, p3keymgmt *keys)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int p3_encrypt           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *&nbsp;</td>
          <td class="paramname"> <em>keys</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>p3_encrypt</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Encrypt a buffer.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>buffer: The buffer to be encrypted. The encrypted data is returned in this buffer.</li><li>size: The size of the buffer, in bytes, which must be a multiple of 16.</li><li>id: The ID of the P3 packet.</li><li>crypto: The session crypto type (ie. p3DATENC1, p3CTLENC0).</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0: OK</li><li>&lt;0: Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3kcrypto_8c-source.html#l00036">crypto_lock</a>, <a class="el" href="p3kcrypto_8h-source.html#l00094">_p3keymgmt::ctlenc0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00096">_p3keymgmt::ctlenc1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00090">_p3keymgmt::datenc0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00092">_p3keymgmt::datenc1</a>, <a class="el" href="aes_8c-source.html#l00081">DoAES()</a>, <a class="el" href="merrors_8c-source.html#l00047">MERROR_lookUpErrorCode()</a>, <a class="el" href="hw__accel_8h-source.html#l00044">MOC_SYM</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3kcrypto_8h-source.html#l00031">p3CTLENC0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00029">p3CTLENC1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00027">p3DATENC0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00025">p3DATENC1</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>, <a class="el" href="p3profile_8c-source.html#l00025">TRUE</a>, and <a class="el" href="p3kcrypto_8c-source.html#l00035">unknown_err</a>.</p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3kcrypto_8h_e807e42de382b4967dcf61a94abf1d63_cgraph.png" border="0" usemap="#p3kcrypto_8h_e807e42de382b4967dcf61a94abf1d63_cgraph_map" alt=""></center>
<map name="p3kcrypto_8h_e807e42de382b4967dcf61a94abf1d63_cgraph_map">
<area shape="rect" href="aes_8c.html#0773743fae8155fec8bf75c087531364" title="DoAES" alt="" coords="209,35,273,61"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="612,9,695,36"><area shape="rect" href="merrors_8c.html#e0fbf1c8cf3bc5beb2c222ef6fb403e2" title="MERROR_lookUpErrorCode" alt="" coords="147,85,336,112"><area shape="rect" href="aes_8h.html#b00b50ef06bf8b54ce973618804586e2" title="AESALGO_blockDecrypt" alt="" coords="384,111,557,137"><area shape="rect" href="aes_8h.html#5c1fa1647ea06de25b72db0239129de6" title="AESALGO_blockEncrypt" alt="" coords="385,60,556,87"><area shape="rect" href="aesalgo_8c.html#4c719df4534cebdf4a32e36b2baeeaf8" title="aesDecrypt" alt="" coords="607,111,700,137"><area shape="rect" href="aesalgo_8c.html#ab1010e729d5c019e6ef9e4dd55a3b96" title="aesEncrypt" alt="" coords="608,60,699,87"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3285d40d28100b2efe0ca06b8d00b2f8"></a><!-- doxytag: member="p3kcrypto.h::p3_decrypt" ref="3285d40d28100b2efe0ca06b8d00b2f8" args="(unsigned char *buffer, int size, unsigned int id, int key, p3keymgmt *keys)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int p3_decrypt           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3keymgmt.html">p3keymgmt</a> *&nbsp;</td>
          <td class="paramname"> <em>keys</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>p3_decrypt</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Decrypt a buffer.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>buffer: The buffer to be decrypted. The decrypted data is returned in this buffer.</li><li>size: The size of the buffer, in bytes, which must be a multiple of 16.</li><li>id: The ID of the P3 packet.</li><li>crypto: The session crypto type (ie. p3DATENC1, p3CTLENC0).</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0: OK</li><li>&lt;0: Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3kcrypto_8c-source.html#l00036">crypto_lock</a>, <a class="el" href="p3kcrypto_8h-source.html#l00095">_p3keymgmt::ctldec0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00097">_p3keymgmt::ctldec1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00091">_p3keymgmt::datdec0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00093">_p3keymgmt::datdec1</a>, <a class="el" href="aes_8c-source.html#l00081">DoAES()</a>, <a class="el" href="p3profile_8c-source.html#l00026">FALSE</a>, <a class="el" href="merrors_8c-source.html#l00047">MERROR_lookUpErrorCode()</a>, <a class="el" href="hw__accel_8h-source.html#l00044">MOC_SYM</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3kcrypto_8h-source.html#l00032">p3CTLDEC0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00030">p3CTLDEC1</a>, <a class="el" href="p3kcrypto_8h-source.html#l00028">p3DATDEC0</a>, <a class="el" href="p3kcrypto_8h-source.html#l00026">p3DATDEC1</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>, and <a class="el" href="p3kcrypto_8c-source.html#l00035">unknown_err</a>.</p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3kcrypto_8h_3285d40d28100b2efe0ca06b8d00b2f8_cgraph.png" border="0" usemap="#p3kcrypto_8h_3285d40d28100b2efe0ca06b8d00b2f8_cgraph_map" alt=""></center>
<map name="p3kcrypto_8h_3285d40d28100b2efe0ca06b8d00b2f8_cgraph_map">
<area shape="rect" href="aes_8c.html#0773743fae8155fec8bf75c087531364" title="DoAES" alt="" coords="209,35,273,61"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="612,9,695,36"><area shape="rect" href="merrors_8c.html#e0fbf1c8cf3bc5beb2c222ef6fb403e2" title="MERROR_lookUpErrorCode" alt="" coords="147,85,336,112"><area shape="rect" href="aes_8h.html#b00b50ef06bf8b54ce973618804586e2" title="AESALGO_blockDecrypt" alt="" coords="384,111,557,137"><area shape="rect" href="aes_8h.html#5c1fa1647ea06de25b72db0239129de6" title="AESALGO_blockEncrypt" alt="" coords="385,60,556,87"><area shape="rect" href="aesalgo_8c.html#4c719df4534cebdf4a32e36b2baeeaf8" title="aesDecrypt" alt="" coords="607,111,700,137"><area shape="rect" href="aesalgo_8c.html#ab1010e729d5c019e6ef9e4dd55a3b96" title="aesEncrypt" alt="" coords="608,60,699,87"></map>
</div>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Sep 24 10:44:28 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
