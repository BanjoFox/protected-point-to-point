<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Velocite Systems Protected Point to Point Solution: p3ksession.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>p3ksession.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>Protected Point to Point primary user interface header file</h3>
<p>
Copyright (C) Velocite 2010 
<p>
<code>#include &quot;<a class="el" href="p3kbase_8h-source.html">p3kbase.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="p3kcrypto_8h-source.html">p3kcrypto.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for p3ksession.h:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h__incl.png" border="0" usemap="#p3ksession.h_map" alt=""></center>
<map name="p3ksession.h_map">
<area shape="rect" href="p3kbase_8h.html" title="p3kbase.h" alt="" coords="737,84,825,111"><area shape="rect" href="p3kcrypto_8h.html" title="p3kcrypto.h" alt="" coords="849,84,945,111"><area shape="rect" href="p3linux_8h.html" title="p3linux.h" alt="" coords="800,161,877,188"></map>
</div>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h__dep__incl.png" border="0" usemap="#p3ksession.hdep_map" alt=""></center>
<map name="p3ksession.hdep_map">
<area shape="rect" href="p3knet_8h.html" title="p3knet.h" alt="" coords="331,84,408,111"><area shape="rect" href="p3kpri__session_8c.html" title="p3kpri_session.c" alt="" coords="5,239,131,265"><area shape="rect" href="p3ksec__session_8c.html" title="p3ksec_session.c" alt="" coords="611,239,741,265"><area shape="rect" href="p3knet_8c.html" title="p3knet.c" alt="" coords="83,161,157,188"><area shape="rect" href="p3kprimary_8h.html" title="p3kprimary.h" alt="" coords="181,161,285,188"><area shape="rect" href="p3ksecondary_8h.html" title="p3ksecondary.h" alt="" coords="309,161,429,188"><area shape="rect" href="p3ksession_8c.html" title="p3ksession.c" alt="" coords="453,161,557,188"><area shape="rect" href="p3linux_8c.html" title="p3linux.c" alt="" coords="581,161,659,188"><area shape="rect" href="p3kprimary_8c.html" title="p3kprimary.c" alt="" coords="167,239,268,265"><area shape="rect" href="p3kprimaryplus_8h.html" title="p3kprimaryplus.h" alt="" coords="292,239,423,265"><area shape="rect" href="p3kprimaryplus_8c.html" title="p3kprimaryplus.c" alt="" coords="292,316,423,343"><area shape="rect" href="p3ksecondary_8c.html" title="p3ksecondary.c" alt="" coords="447,239,567,265"></map>
</div>

<p>
<a href="p3ksession_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3host.html">_p3host</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3session.html">_p3session</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3ctlmsg.html">_p3ctlmsg</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#7865bcf6503e04d9382352ce7ed762d0">p3STYPE_DATA</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#7637dca689aeb78a65ee26565104b8af">p3STYPE_CTL</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#3634812481b4bd70d43af29305fb2d9e">p3MAX_MSG_SZ</a>&nbsp;&nbsp;&nbsp;1460 - 96 - 16</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#bb2288f4e0941b2c95c5b25e5cb6adca">p3CMSG_KTYPE</a>&nbsp;&nbsp;&nbsp;0x0f</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#061808a57374df904b2186e5f454ea0b">p3CMSG_SET_KEY_ARRAY</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#51cf502b86b9c685a1375c180ab87d6b">p3CMSG_ACK_KEY_ARRAY</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#60effa9bb3acb2f6ef9175c8ff5fa422">p3CMSG_AKKERR</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#2bbf1f59b4aa3cc6fbab2efb27c8e5b5">p3CMSG_AKDERR</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#94d6c480ed9c43a278a83e53d4101fa2">p3CMSG_AKERR</a>&nbsp;&nbsp;&nbsp;(p3CMSG_AKKERR | p3CMSG_AKDERR)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#e115d3fa059167950439b75e643f6078">p3CMSG_REPLACE_KEY</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#cd2e35cea676bb2909d9509768a44146">p3CMSG_KRCIDX</a>&nbsp;&nbsp;&nbsp;0x10</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#d61c7c51aded08bbac13307cc51b465d">p3CMSG_KRDIDX</a>&nbsp;&nbsp;&nbsp;0x20</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#ef9a285d8e3f1f7c90b8c74505353584">p3CMSG_KRXMIT</a>&nbsp;&nbsp;&nbsp;0x40</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#2e133285694777e39e31760f8a2b6fcd">p3CMSG_REKEY</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#4299bc16975e94f62d29a7ca5eede120">p3CMSG_RKCKERR</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#aef51b321e51d4348536adf749cf7435">p3CMSG_RKCIERR</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#cd6f814855971dbe1c77d37c108943af">p3CMSG_RKDKERR</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#492f580aab5642ecb85e8f869a76ea2c">p3CMSG_RKDIERR</a>&nbsp;&nbsp;&nbsp;0x08</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#99c66991c3cf74c322a5769e07679b56">p3CMSG_RKERR</a>&nbsp;&nbsp;&nbsp;(p3CMSG_RKCKERR | p3CMSG_RKCIERR | p3CMSG_RKDKERR | p3CMSG_RKDIERR)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#c748fd7feb032391afebc731f790f56a">p3CMSG_REKEY_TEST</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#398e02376281a1b3cd8208fe1b17ad4f">p3CMSG_HRTBEAT_QUERY</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#dfa37ed42ccf906c7a788f3f2bb03826">p3CMSG_HRTBEAT_ANSWER</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#543f5ec4a1b0b7f0549bc413f73b5586">p3CMSG_STATUS_REQ</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#8e31244e34ae5708962bf3712b830266">p3CMSG_STATUS_RESP</a>&nbsp;&nbsp;&nbsp;9</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#8de27e6fe7405f092bbd2c3a90c37cfb">p3CMSG_UPDATE_INFO</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#03d965ba32775ac2f7c97fbab42ded2a">p3CMSG_UICODE</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#6b3609778ab6fbc6ab688c6af4f79356">p3CMSG_UICFG</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#3f75c6ea278157b0eb0993d747f53df6">p3CMSG_ACK_UPDATE</a>&nbsp;&nbsp;&nbsp;11</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#62797f64bcb93703748196db607fadde">p3CMSG_AUDERR</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#082def1cf239e3d9b45d1860d55cd099">p3CMSG_AUUERR</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#5881c3270ca66214f0b6075dd954d489">p3CMSG_AUERR</a>&nbsp;&nbsp;&nbsp;(p3CMSG_AUDERR | p3CMSG_AUUERR)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#9e94ca9b2829d819d4496f75bc3fcdbd">p3CMSG_SHUTDOWN</a>&nbsp;&nbsp;&nbsp;12</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#e842f02f8e3475ad06ae167f37e74b8f">p3CMSG_SHRIMM</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#1ff1b2efb3799c797e0dc2f873f60dc6">p3CMSG_SHRTIME</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#177f13de6abc0656f1ee447cb2cda956">p3CMSG_ACK_SHUTDOWN</a>&nbsp;&nbsp;&nbsp;13</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#37d2936f2f3ec2617bd3dffd0d9e375a">p3CMSG_ASACK</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#e25cdb0fc8d9405af2e1d838190e8058">p3PRI_PORT</a>&nbsp;&nbsp;&nbsp;5653</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#3c14f8ddeab89a8726747ca84eece3db">p3HST_ID</a>&nbsp;&nbsp;&nbsp;0x000fffff</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#914075881b1f86db2f10b186c6ad39d7">p3HST_IPVER</a>&nbsp;&nbsp;&nbsp;0x00300000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#ba0ca1bccab88a2db5eee3eccb37b151">p3HST_IPV4</a>&nbsp;&nbsp;&nbsp;0x00100000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#5503acd61ffac5e7e01093df4da48a98">p3HST_IPV6</a>&nbsp;&nbsp;&nbsp;0x00200000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#8cf910627d799296aab0adb1654e4a49">p3HST_ARRAY</a>&nbsp;&nbsp;&nbsp;0x00400000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#fa29262b01aaf5ca4df0111353209440">p3HST_KTYPE</a>&nbsp;&nbsp;&nbsp;0x0f000000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#9e677ac9a1dafc9c69ec7b154818145c">p3HST_KTSHF</a>&nbsp;&nbsp;&nbsp;24</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#f4e1093b9606a7e69af043deac39d328">p3SEQ_DIFF</a>&nbsp;&nbsp;&nbsp;0xa65d</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#82a29952aadff952e66b5e30720bc993">p3HDR_SIZE</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#084dba7a9188ac18a605c1cbcdacceac">p3SESSION_HDR4</a>&nbsp;&nbsp;&nbsp;(20 + p3HDR_SIZE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#68e2803e89fe27fa75b01b8963aa3603">p3SESSION_HDR6</a>&nbsp;&nbsp;&nbsp;(40 + p3HDR_SIZE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#2b1cda3dbead589adbba8a14f49affbd">p3CONTROL_HDR4</a>&nbsp;&nbsp;&nbsp;28</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#f5c3acb28cef94a260d19d128f17243f">p3CONTROL_HDR6</a>&nbsp;&nbsp;&nbsp;48</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#5c29a45843967833c199b2b48773f76e">p3PSS_KTYPE</a>&nbsp;&nbsp;&nbsp;0x0000000f</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#33e51f395cf250c819a85f7414f7fadd">p3PSS_ACT</a>&nbsp;&nbsp;&nbsp;0x00000010</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#5172998741eb3c478ba07e314836b58f">p3PSS_REKEY</a>&nbsp;&nbsp;&nbsp;0x00000020</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#189fb68247b8335bf616ae1aa2ff6a66">p3PSS_DRDY</a>&nbsp;&nbsp;&nbsp;0x00000040</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#bd1975fff5ee5bac77be87a62c88b515">p3PSS_CRDY</a>&nbsp;&nbsp;&nbsp;0x00000080</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#5522a5bfa6815eafcbabcfff00750ff9">p3SESSION_SIZE</a>&nbsp;&nbsp;&nbsp;(sizeof(<a class="el" href="struct__p3session.html">p3session</a>) + (p3KMG_KEYS * sizeof(<a class="el" href="struct__p3key.html">p3key</a>)))</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3host.html">_p3host</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#2451d0f50f1cf3819034ff86bc181468">p3host</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3session.html">_p3session</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#9b6cd103bb13010761e047886b00a731">p3session</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3ctlmsg.html">_p3ctlmsg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#9e91c012ed0c808ee4066a8009b65b3d">p3ctlmsg</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#67c0368da866a1d40d64c5c5f62c0da5">init_session</a> (<a class="el" href="struct__p3host.html">p3host</a> *<a class="el" href="planning_8txt.html#67db5ca565845ab69d176efade637c1e">host</a>, void *srcaddr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#82ba0db0ef7ddf7e28cc28fab0761aa3">build_newkey_message</a> (unsigned int flag, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>, <a class="el" href="struct__p3key__mgr.html">p3key_mgr</a> *key_mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#0afcca28441ee6077ad65ec7cbd04501">build_flag_message</a> (int type, unsigned int flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#4a5a8ada1f7c67ee101fd8f2865b8436">build_vlen_message</a> (int type, unsigned int flag, unsigned char *message, int len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#61826257e17f2923e2300451ceb58d58">build_heartbeat_message</a> (int type, unsigned int sequence)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#594393343fee6c7a0fc9c6d7fc6ba265">build_ctl_message</a> (int type, unsigned char *message, int len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#ccd384ee6eff17fb46a44bcd0a2e8ed9">parse_ctl_message</a> (<a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *ctlmsg, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#e6ac2eec53f264e9505e546d52d8c0b2">pri_session_manager</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#ca3d48d1ee35eb9d228250606f4394c3">key_array_error</a> (int flag, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#52a21487fa0fd6103b29853aa2152f58">rekey_session</a> (int flag, unsigned int key_num, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#1e7a96342264a49601111f552b6b0219">rekey_test_pri</a> (unsigned char *message, int size, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#9bb8f1ec82fa429ae11637caa19bf1f5">heartbeat_answer</a> (unsigned int time, unsigned int seqnum, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#2a09f4621c3873e241c9004c0438cc77">sec_session_manager</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#6630ebbd7b47ed8338e449d26f9958ec">set_key_array</a> (unsigned char *message, int ksize, int dsize, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#2cee32c0152fbe0cb76c0739d0c72246">replace_key</a> (unsigned char *dkey, int dindex, unsigned char *ckey, int cindex, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#52262f83863e788f79c32917699172be">rekey_test_sec</a> (unsigned char *message, int size, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#11bf297973fd2df2fb5da58abc220f3e">heartbeat_query</a> (unsigned int time, unsigned int seqnum, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="7865bcf6503e04d9382352ce7ed762d0"></a><!-- doxytag: member="p3ksession.h::p3STYPE_DATA" ref="7865bcf6503e04d9382352ce7ed762d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3STYPE_DATA&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="7637dca689aeb78a65ee26565104b8af"></a><!-- doxytag: member="p3ksession.h::p3STYPE_CTL" ref="7637dca689aeb78a65ee26565104b8af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3STYPE_CTL&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="3634812481b4bd70d43af29305fb2d9e"></a><!-- doxytag: member="p3ksession.h::p3MAX_MSG_SZ" ref="3634812481b4bd70d43af29305fb2d9e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3MAX_MSG_SZ&nbsp;&nbsp;&nbsp;1460 - 96 - 16          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bb2288f4e0941b2c95c5b25e5cb6adca"></a><!-- doxytag: member="p3ksession.h::p3CMSG_KTYPE" ref="bb2288f4e0941b2c95c5b25e5cb6adca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KTYPE&nbsp;&nbsp;&nbsp;0x0f          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="061808a57374df904b2186e5f454ea0b"></a><!-- doxytag: member="p3ksession.h::p3CMSG_SET_KEY_ARRAY" ref="061808a57374df904b2186e5f454ea0b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SET_KEY_ARRAY&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, and <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="51cf502b86b9c685a1375c180ab87d6b"></a><!-- doxytag: member="p3ksession.h::p3CMSG_ACK_KEY_ARRAY" ref="51cf502b86b9c685a1375c180ab87d6b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ACK_KEY_ARRAY&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="60effa9bb3acb2f6ef9175c8ff5fa422"></a><!-- doxytag: member="p3ksession.h::p3CMSG_AKKERR" ref="60effa9bb3acb2f6ef9175c8ff5fa422" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AKKERR&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="2bbf1f59b4aa3cc6fbab2efb27c8e5b5"></a><!-- doxytag: member="p3ksession.h::p3CMSG_AKDERR" ref="2bbf1f59b4aa3cc6fbab2efb27c8e5b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AKDERR&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="94d6c480ed9c43a278a83e53d4101fa2"></a><!-- doxytag: member="p3ksession.h::p3CMSG_AKERR" ref="94d6c480ed9c43a278a83e53d4101fa2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AKERR&nbsp;&nbsp;&nbsp;(p3CMSG_AKKERR | p3CMSG_AKDERR)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e115d3fa059167950439b75e643f6078"></a><!-- doxytag: member="p3ksession.h::p3CMSG_REPLACE_KEY" ref="e115d3fa059167950439b75e643f6078" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_REPLACE_KEY&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="cd2e35cea676bb2909d9509768a44146"></a><!-- doxytag: member="p3ksession.h::p3CMSG_KRCIDX" ref="cd2e35cea676bb2909d9509768a44146" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KRCIDX&nbsp;&nbsp;&nbsp;0x10          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d61c7c51aded08bbac13307cc51b465d"></a><!-- doxytag: member="p3ksession.h::p3CMSG_KRDIDX" ref="d61c7c51aded08bbac13307cc51b465d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KRDIDX&nbsp;&nbsp;&nbsp;0x20          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ef9a285d8e3f1f7c90b8c74505353584"></a><!-- doxytag: member="p3ksession.h::p3CMSG_KRXMIT" ref="ef9a285d8e3f1f7c90b8c74505353584" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KRXMIT&nbsp;&nbsp;&nbsp;0x40          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="2e133285694777e39e31760f8a2b6fcd"></a><!-- doxytag: member="p3ksession.h::p3CMSG_REKEY" ref="2e133285694777e39e31760f8a2b6fcd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_REKEY&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>, <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>, and <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4299bc16975e94f62d29a7ca5eede120"></a><!-- doxytag: member="p3ksession.h::p3CMSG_RKCKERR" ref="4299bc16975e94f62d29a7ca5eede120" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_RKCKERR&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="aef51b321e51d4348536adf749cf7435"></a><!-- doxytag: member="p3ksession.h::p3CMSG_RKCIERR" ref="aef51b321e51d4348536adf749cf7435" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_RKCIERR&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>.</p>

</div>
</div><p>
<a class="anchor" name="cd6f814855971dbe1c77d37c108943af"></a><!-- doxytag: member="p3ksession.h::p3CMSG_RKDKERR" ref="cd6f814855971dbe1c77d37c108943af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_RKDKERR&nbsp;&nbsp;&nbsp;0x04          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="492f580aab5642ecb85e8f869a76ea2c"></a><!-- doxytag: member="p3ksession.h::p3CMSG_RKDIERR" ref="492f580aab5642ecb85e8f869a76ea2c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_RKDIERR&nbsp;&nbsp;&nbsp;0x08          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>.</p>

</div>
</div><p>
<a class="anchor" name="99c66991c3cf74c322a5769e07679b56"></a><!-- doxytag: member="p3ksession.h::p3CMSG_RKERR" ref="99c66991c3cf74c322a5769e07679b56" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_RKERR&nbsp;&nbsp;&nbsp;(p3CMSG_RKCKERR | p3CMSG_RKCIERR | p3CMSG_RKDKERR | p3CMSG_RKDIERR)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c748fd7feb032391afebc731f790f56a"></a><!-- doxytag: member="p3ksession.h::p3CMSG_REKEY_TEST" ref="c748fd7feb032391afebc731f790f56a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_REKEY_TEST&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, and <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="398e02376281a1b3cd8208fe1b17ad4f"></a><!-- doxytag: member="p3ksession.h::p3CMSG_HRTBEAT_QUERY" ref="398e02376281a1b3cd8208fe1b17ad4f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_HRTBEAT_QUERY&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="dfa37ed42ccf906c7a788f3f2bb03826"></a><!-- doxytag: member="p3ksession.h::p3CMSG_HRTBEAT_ANSWER" ref="dfa37ed42ccf906c7a788f3f2bb03826" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_HRTBEAT_ANSWER&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="543f5ec4a1b0b7f0549bc413f73b5586"></a><!-- doxytag: member="p3ksession.h::p3CMSG_STATUS_REQ" ref="543f5ec4a1b0b7f0549bc413f73b5586" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_STATUS_REQ&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, and <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8e31244e34ae5708962bf3712b830266"></a><!-- doxytag: member="p3ksession.h::p3CMSG_STATUS_RESP" ref="8e31244e34ae5708962bf3712b830266" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_STATUS_RESP&nbsp;&nbsp;&nbsp;9          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, and <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8de27e6fe7405f092bbd2c3a90c37cfb"></a><!-- doxytag: member="p3ksession.h::p3CMSG_UPDATE_INFO" ref="8de27e6fe7405f092bbd2c3a90c37cfb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_UPDATE_INFO&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, and <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="03d965ba32775ac2f7c97fbab42ded2a"></a><!-- doxytag: member="p3ksession.h::p3CMSG_UICODE" ref="03d965ba32775ac2f7c97fbab42ded2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_UICODE&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="6b3609778ab6fbc6ab688c6af4f79356"></a><!-- doxytag: member="p3ksession.h::p3CMSG_UICFG" ref="6b3609778ab6fbc6ab688c6af4f79356" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_UICFG&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="3f75c6ea278157b0eb0993d747f53df6"></a><!-- doxytag: member="p3ksession.h::p3CMSG_ACK_UPDATE" ref="3f75c6ea278157b0eb0993d747f53df6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ACK_UPDATE&nbsp;&nbsp;&nbsp;11          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="62797f64bcb93703748196db607fadde"></a><!-- doxytag: member="p3ksession.h::p3CMSG_AUDERR" ref="62797f64bcb93703748196db607fadde" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AUDERR&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="082def1cf239e3d9b45d1860d55cd099"></a><!-- doxytag: member="p3ksession.h::p3CMSG_AUUERR" ref="082def1cf239e3d9b45d1860d55cd099" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AUUERR&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5881c3270ca66214f0b6075dd954d489"></a><!-- doxytag: member="p3ksession.h::p3CMSG_AUERR" ref="5881c3270ca66214f0b6075dd954d489" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AUERR&nbsp;&nbsp;&nbsp;(p3CMSG_AUDERR | p3CMSG_AUUERR)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="9e94ca9b2829d819d4496f75bc3fcdbd"></a><!-- doxytag: member="p3ksession.h::p3CMSG_SHUTDOWN" ref="9e94ca9b2829d819d4496f75bc3fcdbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SHUTDOWN&nbsp;&nbsp;&nbsp;12          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e842f02f8e3475ad06ae167f37e74b8f"></a><!-- doxytag: member="p3ksession.h::p3CMSG_SHRIMM" ref="e842f02f8e3475ad06ae167f37e74b8f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SHRIMM&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="1ff1b2efb3799c797e0dc2f873f60dc6"></a><!-- doxytag: member="p3ksession.h::p3CMSG_SHRTIME" ref="1ff1b2efb3799c797e0dc2f873f60dc6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SHRTIME&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="177f13de6abc0656f1ee447cb2cda956"></a><!-- doxytag: member="p3ksession.h::p3CMSG_ACK_SHUTDOWN" ref="177f13de6abc0656f1ee447cb2cda956" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ACK_SHUTDOWN&nbsp;&nbsp;&nbsp;13          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="37d2936f2f3ec2617bd3dffd0d9e375a"></a><!-- doxytag: member="p3ksession.h::p3CMSG_ASACK" ref="37d2936f2f3ec2617bd3dffd0d9e375a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ASACK&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="e25cdb0fc8d9405af2e1d838190e8058"></a><!-- doxytag: member="p3ksession.h::p3PRI_PORT" ref="e25cdb0fc8d9405af2e1d838190e8058" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PRI_PORT&nbsp;&nbsp;&nbsp;5653          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="3c14f8ddeab89a8726747ca84eece3db"></a><!-- doxytag: member="p3ksession.h::p3HST_ID" ref="3c14f8ddeab89a8726747ca84eece3db" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HST_ID&nbsp;&nbsp;&nbsp;0x000fffff          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="914075881b1f86db2f10b186c6ad39d7"></a><!-- doxytag: member="p3ksession.h::p3HST_IPVER" ref="914075881b1f86db2f10b186c6ad39d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HST_IPVER&nbsp;&nbsp;&nbsp;0x00300000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00038">init_session()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ba0ca1bccab88a2db5eee3eccb37b151"></a><!-- doxytag: member="p3ksession.h::p3HST_IPV4" ref="ba0ca1bccab88a2db5eee3eccb37b151" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HST_IPV4&nbsp;&nbsp;&nbsp;0x00100000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5503acd61ffac5e7e01093df4da48a98"></a><!-- doxytag: member="p3ksession.h::p3HST_IPV6" ref="5503acd61ffac5e7e01093df4da48a98" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HST_IPV6&nbsp;&nbsp;&nbsp;0x00200000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="8cf910627d799296aab0adb1654e4a49"></a><!-- doxytag: member="p3ksession.h::p3HST_ARRAY" ref="8cf910627d799296aab0adb1654e4a49" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HST_ARRAY&nbsp;&nbsp;&nbsp;0x00400000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="fa29262b01aaf5ca4df0111353209440"></a><!-- doxytag: member="p3ksession.h::p3HST_KTYPE" ref="fa29262b01aaf5ca4df0111353209440" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HST_KTYPE&nbsp;&nbsp;&nbsp;0x0f000000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="9e677ac9a1dafc9c69ec7b154818145c"></a><!-- doxytag: member="p3ksession.h::p3HST_KTSHF" ref="9e677ac9a1dafc9c69ec7b154818145c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HST_KTSHF&nbsp;&nbsp;&nbsp;24          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="f4e1093b9606a7e69af043deac39d328"></a><!-- doxytag: member="p3ksession.h::p3SEQ_DIFF" ref="f4e1093b9606a7e69af043deac39d328" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3SEQ_DIFF&nbsp;&nbsp;&nbsp;0xa65d          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="82a29952aadff952e66b5e30720bc993"></a><!-- doxytag: member="p3ksession.h::p3HDR_SIZE" ref="82a29952aadff952e66b5e30720bc993" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3HDR_SIZE&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="084dba7a9188ac18a605c1cbcdacceac"></a><!-- doxytag: member="p3ksession.h::p3SESSION_HDR4" ref="084dba7a9188ac18a605c1cbcdacceac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3SESSION_HDR4&nbsp;&nbsp;&nbsp;(20 + p3HDR_SIZE)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>, and <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

</div>
</div><p>
<a class="anchor" name="68e2803e89fe27fa75b01b8963aa3603"></a><!-- doxytag: member="p3ksession.h::p3SESSION_HDR6" ref="68e2803e89fe27fa75b01b8963aa3603" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3SESSION_HDR6&nbsp;&nbsp;&nbsp;(40 + p3HDR_SIZE)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2b1cda3dbead589adbba8a14f49affbd"></a><!-- doxytag: member="p3ksession.h::p3CONTROL_HDR4" ref="2b1cda3dbead589adbba8a14f49affbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CONTROL_HDR4&nbsp;&nbsp;&nbsp;28          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, and <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f5c3acb28cef94a260d19d128f17243f"></a><!-- doxytag: member="p3ksession.h::p3CONTROL_HDR6" ref="f5c3acb28cef94a260d19d128f17243f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CONTROL_HDR6&nbsp;&nbsp;&nbsp;48          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5c29a45843967833c199b2b48773f76e"></a><!-- doxytag: member="p3ksession.h::p3PSS_KTYPE" ref="5c29a45843967833c199b2b48773f76e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PSS_KTYPE&nbsp;&nbsp;&nbsp;0x0000000f          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00038">init_session()</a>, <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>, and <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>.</p>

</div>
</div><p>
<a class="anchor" name="33e51f395cf250c819a85f7414f7fadd"></a><!-- doxytag: member="p3ksession.h::p3PSS_ACT" ref="33e51f395cf250c819a85f7414f7fadd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PSS_ACT&nbsp;&nbsp;&nbsp;0x00000010          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>, and <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5172998741eb3c478ba07e314836b58f"></a><!-- doxytag: member="p3ksession.h::p3PSS_REKEY" ref="5172998741eb3c478ba07e314836b58f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PSS_REKEY&nbsp;&nbsp;&nbsp;0x00000020          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>, <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>, <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>, and <a class="el" href="p3kprimary_8c-source.html#l00402">start_rekeying()</a>.</p>

</div>
</div><p>
<a class="anchor" name="189fb68247b8335bf616ae1aa2ff6a66"></a><!-- doxytag: member="p3ksession.h::p3PSS_DRDY" ref="189fb68247b8335bf616ae1aa2ff6a66" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PSS_DRDY&nbsp;&nbsp;&nbsp;0x00000040          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="bd1975fff5ee5bac77be87a62c88b515"></a><!-- doxytag: member="p3ksession.h::p3PSS_CRDY" ref="bd1975fff5ee5bac77be87a62c88b515" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PSS_CRDY&nbsp;&nbsp;&nbsp;0x00000080          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5522a5bfa6815eafcbabcfff00750ff9"></a><!-- doxytag: member="p3ksession.h::p3SESSION_SIZE" ref="5522a5bfa6815eafcbabcfff00750ff9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3SESSION_SIZE&nbsp;&nbsp;&nbsp;(sizeof(<a class="el" href="struct__p3session.html">p3session</a>) + (p3KMG_KEYS * sizeof(<a class="el" href="struct__p3key.html">p3key</a>)))          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="2451d0f50f1cf3819034ff86bc181468"></a><!-- doxytag: member="p3ksession.h::p3host" ref="2451d0f50f1cf3819034ff86bc181468" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3host.html">_p3host</a> <a class="el" href="struct__p3host.html">p3host</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="9b6cd103bb13010761e047886b00a731"></a><!-- doxytag: member="p3ksession.h::p3session" ref="9b6cd103bb13010761e047886b00a731" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3session.html">_p3session</a> <a class="el" href="struct__p3session.html">p3session</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="9e91c012ed0c808ee4066a8009b65b3d"></a><!-- doxytag: member="p3ksession.h::p3ctlmsg" ref="9e91c012ed0c808ee4066a8009b65b3d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3ctlmsg.html">_p3ctlmsg</a> <a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="67c0368da866a1d40d64c5c5f62c0da5"></a><!-- doxytag: member="p3ksession.h::init_session" ref="67c0368da866a1d40d64c5c5f62c0da5" args="(p3host *host, void *srcaddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_session           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3host.html">p3host</a> *&nbsp;</td>
          <td class="paramname"> <em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>srcaddr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>init_session</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Initialize a session. This allocates a new session structure and all of its fields.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>host: The host structure for the session to be initialized.</li><li>srcaddr: The local host address. Because it can be either IPv4 or IPv6, it is passed as a void pointer.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>None. </li></ul>
</dd></dl>

<p>References <a class="el" href="struct__p3host.html#1d30157fd8630192bcadb18c25dacd9f">_p3host::addr</a>, <a class="el" href="p3kcrypto_8h-source.html#l00099">_p3keymgmt::cnewkey</a>, <a class="el" href="p3kcrypto_8h-source.html#l00098">_p3keymgmt::dnewkey</a>, <a class="el" href="p3net_8h-source.html#l00046">_p3host::flag</a>, <a class="el" href="p3ksession_8h-source.html#l00141">_p3session::flag</a>, <a class="el" href="p3ksession_8h-source.html#l00106">_p3session::keymgmt</a>, <a class="el" href="p3ksession_8h-source.html#l00124">_p3session::lock</a>, <a class="el" href="p3ksession_8h-source.html#l00134">_p3session::p3hdr</a>, <a class="el" href="p3net_8h-source.html#l00048">p3HST_IPV4</a>, <a class="el" href="p3net_8h-source.html#l00049">p3HST_IPV6</a>, <a class="el" href="p3ksession_8h-source.html#l00088">p3HST_IPVER</a>, <a class="el" href="p3net_8h-source.html#l00052">p3HST_KTSHF</a>, <a class="el" href="p3net_8h-source.html#l00051">p3HST_KTYPE</a>, <a class="el" href="p3crypto_8h-source.html#l00022">p3KSIZE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00024">p3KSIZE_AES256</a>, <a class="el" href="p3crypto_8h-source.html#l00021">p3KTYPE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00023">p3KTYPE_AES256</a>, <a class="el" href="p3linux_8h-source.html#l00069">p3lock_init</a>, <a class="el" href="p3ksession_8h-source.html#l00142">p3PSS_KTYPE</a>, <a class="el" href="p3ksession_8h-source.html#l00077">_p3host::session</a>, <a class="el" href="p3crypto_8h-source.html#l00041">_p3key::size</a>, <a class="el" href="p3ksession_8h-source.html#l00112">_p3session::sseq</a>, and <a class="el" href="p3net_8h-source.html#l00037">_p3host::v4</a>.</p>

<p>Referenced by <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

</div>
</div><p>
<a class="anchor" name="82ba0db0ef7ddf7e28cc28fab0761aa3"></a><!-- doxytag: member="p3ksession.h::build_newkey_message" ref="82ba0db0ef7ddf7e28cc28fab0761aa3" args="(unsigned int flag, p3session *p3sess, p3key_mgr *key_mgr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_newkey_message           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3key__mgr.html">p3key_mgr</a> *&nbsp;</td>
          <td class="paramname"> <em>key_mgr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kprimary_8c-source.html#l00402">start_rekeying()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0afcca28441ee6077ad65ec7cbd04501"></a><!-- doxytag: member="p3ksession.h::build_flag_message" ref="0afcca28441ee6077ad65ec7cbd04501" args="(int type, unsigned int flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_flag_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_flag_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build a control message that only contains a flag.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>flag: The flag settings</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>unsigned char *: The encrypted message or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00378">build_ctl_message()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h_0afcca28441ee6077ad65ec7cbd04501_cgraph.png" border="0" usemap="#p3ksession_8h_0afcca28441ee6077ad65ec7cbd04501_cgraph_map" alt=""></center>
<map name="p3ksession_8h_0afcca28441ee6077ad65ec7cbd04501_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="204,5,343,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4a5a8ada1f7c67ee101fd8f2865b8436"></a><!-- doxytag: member="p3ksession.h::build_vlen_message" ref="4a5a8ada1f7c67ee101fd8f2865b8436" args="(int type, unsigned int flag, unsigned char *message, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_vlen_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_vlen_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build a varilable length control message. All variable length messages except Rekey Test include a flag.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>flag: The flag settings</li><li>message: The variable length message</li><li>len: The length of the message</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>unsigned char *: The encrypted message or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00378">build_ctl_message()</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3ksession_8h-source.html#l00034">p3CMSG_REKEY</a>, <a class="el" href="p3ksession_8h-source.html#l00041">p3CMSG_REKEY_TEST</a>, <a class="el" href="p3ksession_8h-source.html#l00024">p3CMSG_SET_KEY_ARRAY</a>, <a class="el" href="p3ksession_8h-source.html#l00044">p3CMSG_STATUS_REQ</a>, <a class="el" href="p3ksession_8h-source.html#l00045">p3CMSG_STATUS_RESP</a>, <a class="el" href="p3ksession_8h-source.html#l00046">p3CMSG_UPDATE_INFO</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3ksession_8h-source.html#l00021">p3MAX_MSG_SZ</a>, and <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>.</p>

<p>Referenced by <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>, and <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h_4a5a8ada1f7c67ee101fd8f2865b8436_cgraph.png" border="0" usemap="#p3ksession_8h_4a5a8ada1f7c67ee101fd8f2865b8436_cgraph_map" alt=""></center>
<map name="p3ksession_8h_4a5a8ada1f7c67ee101fd8f2865b8436_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="207,5,345,32"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="235,56,317,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="61826257e17f2923e2300451ceb58d58"></a><!-- doxytag: member="p3ksession.h::build_heartbeat_message" ref="61826257e17f2923e2300451ceb58d58" args="(int type, unsigned int sequence)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_heartbeat_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>sequence</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_heartbeat_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build a heartbeat query or answer message.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>sequence: The heartbeat sequence number</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>unsigned char *: The encrypted message or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00378">build_ctl_message()</a>, <a class="el" href="p3ksession_8c-source.html#l00019">midnight</a>, and <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h_61826257e17f2923e2300451ceb58d58_cgraph.png" border="0" usemap="#p3ksession_8h_61826257e17f2923e2300451ceb58d58_cgraph_map" alt=""></center>
<map name="p3ksession_8h_61826257e17f2923e2300451ceb58d58_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="244,5,383,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="594393343fee6c7a0fc9c6d7fc6ba265"></a><!-- doxytag: member="p3ksession.h::build_ctl_message" ref="594393343fee6c7a0fc9c6d7fc6ba265" args="(int type, unsigned char *message, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_ctl_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_ctl_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build the requested control message and encrypt it. This is called by individual control message build functions.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>message: Message data</li><li>len: Length of message data</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>p3ctlmsg *: The encrypted message structure or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8h-source.html#l00163">_p3ctlmsg::len</a>, <a class="el" href="p3ksession_8h-source.html#l00162">_p3ctlmsg::message</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, and <a class="el" href="p3base_8h-source.html#l00185">p3calloc</a>.</p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00186">build_flag_message()</a>, <a class="el" href="p3ksession_8c-source.html#l00322">build_heartbeat_message()</a>, and <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ccd384ee6eff17fb46a44bcd0a2e8ed9"></a><!-- doxytag: member="p3ksession.h::parse_ctl_message" ref="ccd384ee6eff17fb46a44bcd0a2e8ed9" args="(p3ctlmsg *ctlmsg, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_ctl_message           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td>
          <td class="paramname"> <em>ctlmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>parse_ctl_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Parse a message and call the function to handle it. The format of the Control Messages is: <pre>
 | 4 octets | 1 octet | Variable length |
 | Size     | Command | Data            |
   where the fields are:
 Size:  The total size of the message, including the size field itself
 Command:  An 8-bit number
 Data:  The data, if any, associated with the command
 </pre></dd></dl>
The handler functions must be defined in the primary or secondary session handler, depending on which receives the message. The message handling code is only compiled if the P3 system is the receiver. All message handling is compiled for the Primary Plus Secondary P3 system.<p>
See the P3 System Specification for details on the commands.<p>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>ctlmsg: The message structure, including the buffer with the size field.</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error</li><li>&gt;0 = Status from remote P3 system </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3kpri__session_8c-source.html#l00185">heartbeat_answer()</a>, <a class="el" href="p3ksec__session_8c-source.html#l00268">heartbeat_query()</a>, <a class="el" href="p3kpri__session_8c-source.html#l00072">key_array_error()</a>, <a class="el" href="p3ksession_8h-source.html#l00163">_p3ctlmsg::len</a>, <a class="el" href="p3ksession_8h-source.html#l00162">_p3ctlmsg::message</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3ksession_8h-source.html#l00025">p3CMSG_ACK_KEY_ARRAY</a>, <a class="el" href="p3ksession_8h-source.html#l00057">p3CMSG_ACK_SHUTDOWN</a>, <a class="el" href="p3ksession_8h-source.html#l00049">p3CMSG_ACK_UPDATE</a>, <a class="el" href="p3ksession_8h-source.html#l00028">p3CMSG_AKERR</a>, <a class="el" href="p3ksession_8h-source.html#l00043">p3CMSG_HRTBEAT_ANSWER</a>, <a class="el" href="p3ksession_8h-source.html#l00042">p3CMSG_HRTBEAT_QUERY</a>, <a class="el" href="p3ksession_8h-source.html#l00031">p3CMSG_KRCIDX</a>, <a class="el" href="p3ksession_8h-source.html#l00032">p3CMSG_KRDIDX</a>, <a class="el" href="p3ksession_8h-source.html#l00023">p3CMSG_KTYPE</a>, <a class="el" href="p3ksession_8h-source.html#l00034">p3CMSG_REKEY</a>, <a class="el" href="p3ksession_8h-source.html#l00041">p3CMSG_REKEY_TEST</a>, <a class="el" href="p3ksession_8h-source.html#l00030">p3CMSG_REPLACE_KEY</a>, <a class="el" href="p3ksession_8h-source.html#l00024">p3CMSG_SET_KEY_ARRAY</a>, <a class="el" href="p3ksession_8h-source.html#l00054">p3CMSG_SHUTDOWN</a>, <a class="el" href="p3ksession_8h-source.html#l00044">p3CMSG_STATUS_REQ</a>, <a class="el" href="p3ksession_8h-source.html#l00045">p3CMSG_STATUS_RESP</a>, <a class="el" href="p3ksession_8h-source.html#l00046">p3CMSG_UPDATE_INFO</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3crypto_8h-source.html#l00022">p3KSIZE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00024">p3KSIZE_AES256</a>, <a class="el" href="p3crypto_8h-source.html#l00021">p3KTYPE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00023">p3KTYPE_AES256</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>, <a class="el" href="p3kpri__session_8c-source.html#l00159">rekey_test_pri()</a>, <a class="el" href="p3ksec__session_8c-source.html#l00241">rekey_test_sec()</a>, <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>, and <a class="el" href="p3ksec__session_8c-source.html#l00075">set_key_array()</a>.</p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h_ccd384ee6eff17fb46a44bcd0a2e8ed9_cgraph.png" border="0" usemap="#p3ksession_8h_ccd384ee6eff17fb46a44bcd0a2e8ed9_cgraph_map" alt=""></center>
<map name="p3ksession_8h_ccd384ee6eff17fb46a44bcd0a2e8ed9_cgraph_map">
<area shape="rect" href="p3kpri__session_8c.html#9bb8f1ec82fa429ae11637caa19bf1f5" title="heartbeat_answer" alt="" coords="200,5,336,32"><area shape="rect" href="p3ksec__session_8c.html#11bf297973fd2df2fb5da58abc220f3e" title="heartbeat_query" alt="" coords="204,56,332,83"><area shape="rect" href="p3kpri__session_8c.html#ca3d48d1ee35eb9d228250606f4394c3" title="key_array_error" alt="" coords="208,107,328,133"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="1239,461,1321,488"><area shape="rect" href="p3kpri__session_8c.html#52a21487fa0fd6103b29853aa2152f58" title="rekey_session" alt="" coords="212,309,324,336"><area shape="rect" href="p3kpri__session_8c.html#1e7a96342264a49601111f552b6b0219" title="rekey_test_pri" alt="" coords="404,461,516,488"><area shape="rect" href="p3ksec__session_8c.html#52262f83863e788f79c32917699172be" title="rekey_test_sec" alt="" coords="209,360,327,387"><area shape="rect" href="p3ksec__session_8c.html#2cee32c0152fbe0cb76c0739d0c72246" title="replace_key" alt="" coords="220,208,316,235"><area shape="rect" href="p3ksec__session_8c.html#6630ebbd7b47ed8338e449d26f9958ec" title="set_key_array" alt="" coords="213,411,323,437"><area shape="rect" href="p3ksession_8c.html#4a5a8ada1f7c67ee101fd8f2865b8436" title="build_vlen_message" alt="" coords="385,259,535,285"><area shape="rect" href="p3knet_8c.html#e42b8ad940d0e2e7f53e7e4096934645" title="p3send_control" alt="" coords="400,385,520,412"><area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="585,259,724,285"><area shape="rect" href="p3kcrypto_8c.html#e807e42de382b4967dcf61a94abf1d63" title="p3_encrypt" alt="" coords="609,461,700,488"><area shape="rect" href="p3linux_8c.html#61e0f4c4c3ee65ef0c0c47c5766d25fc" title="p3net_utils" alt="" coords="609,411,700,437"><area shape="rect" href="aes_8c.html#0773743fae8155fec8bf75c087531364" title="DoAES" alt="" coords="836,588,900,615"><area shape="rect" href="merrors_8c.html#e0fbf1c8cf3bc5beb2c222ef6fb403e2" title="MERROR_lookUpErrorCode" alt="" coords="773,411,963,437"><area shape="rect" href="aes_8h.html#b00b50ef06bf8b54ce973618804586e2" title="AESALGO_blockDecrypt" alt="" coords="1011,664,1184,691"><area shape="rect" href="aes_8h.html#5c1fa1647ea06de25b72db0239129de6" title="AESALGO_blockEncrypt" alt="" coords="1012,613,1183,640"><area shape="rect" href="aesalgo_8c.html#4c719df4534cebdf4a32e36b2baeeaf8" title="aesDecrypt" alt="" coords="1233,664,1327,691"><area shape="rect" href="aesalgo_8c.html#ab1010e729d5c019e6ef9e4dd55a3b96" title="aesEncrypt" alt="" coords="1235,613,1325,640"></map>
</div>

</div>
</div><p>
<a class="anchor" name="e6ac2eec53f264e9505e546d52d8c0b2"></a><!-- doxytag: member="p3ksession.h::pri_session_manager" ref="e6ac2eec53f264e9505e546d52d8c0b2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pri_session_manager           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>session_manager</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Manage the primary to secondary session.</dd></dl>
NOTE: If implemented as a continuous child process, see sendmsg, recvmsg, and cmsg for passing socket file descriptors.<p>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>None</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error </li></ul>
</li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="ca3d48d1ee35eb9d228250606f4394c3"></a><!-- doxytag: member="p3ksession.h::key_array_error" ref="ca3d48d1ee35eb9d228250606f4394c3" args="(int flag, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void key_array_error           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>key_array_error</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Handle a key array error message from the secondary session.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>flag: Indicates the specific error</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>None </li></ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="52a21487fa0fd6103b29853aa2152f58"></a><!-- doxytag: member="p3ksession.h::rekey_session" ref="52a21487fa0fd6103b29853aa2152f58" args="(int flag, unsigned int key_num, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rekey_session           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>key_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>rekey_session</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Start using a replacement key from the secondary. The primary sends a Rekey message as acknowledgment to the secondary.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>flag: The result flag from the secondmary</li><li>key_num: The packet ID of the first packet to use the new key</li><li>p3sess: The session structure for the current P3 session</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>None</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Function:</b></dt><dd>rekey_session</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Start using a replacement key from the primary.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>flag: The result flag from the primary</li><li>key_num: The packet ID of the first packet to use the new key</li><li>p3sess: The session structure for the current P3 session</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>None </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, <a class="el" href="p3ksession_8h-source.html#l00141">_p3session::flag</a>, <a class="el" href="p3ksession_8h-source.html#l00106">_p3session::keymgmt</a>, <a class="el" href="p3ksession_8h-source.html#l00124">_p3session::lock</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3kcrypto_8c-source.html#l00290">p3_rekey()</a>, <a class="el" href="p3ksession_8h-source.html#l00034">p3CMSG_REKEY</a>, <a class="el" href="p3ksession_8h-source.html#l00039">p3CMSG_RKERR</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, <a class="el" href="p3ksession_8h-source.html#l00144">p3PSS_REKEY</a>, <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>, <a class="el" href="p3ksession_8h-source.html#l00114">_p3session::rID0</a>, <a class="el" href="p3ksession_8h-source.html#l00115">_p3session::rID1</a>, and <a class="el" href="p3ksession_8h-source.html#l00112">_p3session::sseq</a>.</p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h_52a21487fa0fd6103b29853aa2152f58_cgraph.png" border="0" usemap="#p3ksession_8h_52a21487fa0fd6103b29853aa2152f58_cgraph_map" alt=""></center>
<map name="p3ksession_8h_52a21487fa0fd6103b29853aa2152f58_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#4a5a8ada1f7c67ee101fd8f2865b8436" title="build_vlen_message" alt="" coords="167,81,316,108"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="1037,309,1120,336"><area shape="rect" href="p3kcrypto_8c.html#2e8e3ba5d89461cd203f9347c9692f3c" title="p3_rekey" alt="" coords="201,208,281,235"><area shape="rect" href="p3knet_8c.html#e42b8ad940d0e2e7f53e7e4096934645" title="p3send_control" alt="" coords="181,360,301,387"><area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="367,31,505,57"><area shape="rect" href="aes_8c.html#e6725f8404860044aeb3bb02a46006b4" title="DeleteAESCtx" alt="" coords="381,183,491,209"><area shape="rect" href="p3kcrypto_8c.html#2fff99ba7e77678db3154d219a8014d0" title="p3_init_crypto" alt="" coords="381,132,491,159"><area shape="rect" href="aes_8c.html#907a0fa24742e214cf5745ef2c4c2d26" title="CreateAESCtx" alt="" coords="593,132,705,159"><area shape="rect" href="aes_8h.html#2d6be417e64bdeddfc5c0c035fb6d176" title="AESALGO_makeAesKey" alt="" coords="793,31,964,57"><area shape="rect" href="aesalgo_8c.html#94c062eb10035b9a2d630b4d7c1a5fc7" title="aesKeySetupDec" alt="" coords="1015,5,1143,32"><area shape="rect" href="aesalgo_8c.html#fd719d98c97fc2800b503dfe71eaedef" title="aesKeySetupEnc" alt="" coords="1192,31,1320,57"><area shape="rect" href="p3kcrypto_8c.html#e807e42de382b4967dcf61a94abf1d63" title="p3_encrypt" alt="" coords="391,385,481,412"><area shape="rect" href="p3linux_8c.html#61e0f4c4c3ee65ef0c0c47c5766d25fc" title="p3net_utils" alt="" coords="391,436,481,463"><area shape="rect" href="aes_8c.html#0773743fae8155fec8bf75c087531364" title="DoAES" alt="" coords="617,436,681,463"><area shape="rect" href="merrors_8c.html#e0fbf1c8cf3bc5beb2c222ef6fb403e2" title="MERROR_lookUpErrorCode" alt="" coords="555,487,744,513"><area shape="rect" href="aes_8h.html#b00b50ef06bf8b54ce973618804586e2" title="AESALGO_blockDecrypt" alt="" coords="792,537,965,564"><area shape="rect" href="aes_8h.html#5c1fa1647ea06de25b72db0239129de6" title="AESALGO_blockEncrypt" alt="" coords="793,487,964,513"><area shape="rect" href="aesalgo_8c.html#4c719df4534cebdf4a32e36b2baeeaf8" title="aesDecrypt" alt="" coords="1032,537,1125,564"><area shape="rect" href="aesalgo_8c.html#ab1010e729d5c019e6ef9e4dd55a3b96" title="aesEncrypt" alt="" coords="1033,487,1124,513"></map>
</div>

</div>
</div><p>
<a class="anchor" name="1e7a96342264a49601111f552b6b0219"></a><!-- doxytag: member="p3ksession.h::rekey_test_pri" ref="1e7a96342264a49601111f552b6b0219" args="(unsigned char *message, int size, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rekey_test_pri           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>rekey_test_pri</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Receive a message from a secondary, reverse it and compare it to the original test message.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>message: The message from the secondary</li><li>size: The size of the message</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, and <a class="el" href="p3base_8h-source.html#l00050">p3MSG_INFO</a>.</p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h_1e7a96342264a49601111f552b6b0219_cgraph.png" border="0" usemap="#p3ksession_8h_1e7a96342264a49601111f552b6b0219_cgraph_map" alt=""></center>
<map name="p3ksession_8h_1e7a96342264a49601111f552b6b0219_cgraph_map">
<area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="167,5,249,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9bb8f1ec82fa429ae11637caa19bf1f5"></a><!-- doxytag: member="p3ksession.h::heartbeat_answer" ref="9bb8f1ec82fa429ae11637caa19bf1f5" args="(unsigned int time, unsigned int seqnum, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void heartbeat_answer           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>seqnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>heartbeat_answer</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Handle a heartbeat answer message from a secondary.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>time: The P3 time that the message was sent</li><li>seqnum: The sequence number of the query</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>None </li></ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2a09f4621c3873e241c9004c0438cc77"></a><!-- doxytag: member="p3ksession.h::sec_session_manager" ref="2a09f4621c3873e241c9004c0438cc77" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sec_session_manager           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>session_manager</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Manage the secondary to secondary session.</dd></dl>
NOTE: If implemented as a continuous child process, see sendmsg, recvmsg, and cmsg for passing socket file descriptors.<p>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>None</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error </li></ul>
</li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="6630ebbd7b47ed8338e449d26f9958ec"></a><!-- doxytag: member="p3ksession.h::set_key_array" ref="6630ebbd7b47ed8338e449d26f9958ec" args="(unsigned char *message, int ksize, int dsize, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_key_array           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>set_key_array</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Receive an array of keys from the primary. The secondary stores these in an array for when an index is used to indicate the key replacement.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>message: The array of keys</li><li>ksize: The key size</li><li>dsize: The number of keys in the array</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status (see the errors for the p3CMSG_ACK_KEY_ARRAY field) </li></ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2cee32c0152fbe0cb76c0739d0c72246"></a><!-- doxytag: member="p3ksession.h::replace_key" ref="2cee32c0152fbe0cb76c0739d0c72246" args="(unsigned char *dkey, int dindex, unsigned char *ckey, int cindex, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int replace_key           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>dkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>ckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>replace_key</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Replace the data and control keys from the primary using the key or index sent in the message.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>dkey: The data key contained in the message or NULL</li><li>dindex: The data key index contained in the message or length of key</li><li>ckey: The control key contained in the message or NULL</li><li>cindex: The control key index contained in the message or length of key</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status (see the errors for the p3CMSG_KEY_STATUS field) </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>, <a class="el" href="p3kcrypto_8h-source.html#l00099">_p3keymgmt::cnewkey</a>, <a class="el" href="p3kcrypto_8h-source.html#l00098">_p3keymgmt::dnewkey</a>, <a class="el" href="p3ksession_8h-source.html#l00141">_p3session::flag</a>, <a class="el" href="p3crypto_8h-source.html#l00040">_p3key::key</a>, <a class="el" href="p3ksession_8h-source.html#l00107">_p3session::keylist</a>, <a class="el" href="p3ksession_8h-source.html#l00106">_p3session::keymgmt</a>, <a class="el" href="p3ksession_8h-source.html#l00108">_p3session::listsize</a>, <a class="el" href="p3ksession_8h-source.html#l00124">_p3session::lock</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3ksession_8h-source.html#l00034">p3CMSG_REKEY</a>, <a class="el" href="p3ksession_8h-source.html#l00036">p3CMSG_RKCIERR</a>, <a class="el" href="p3ksession_8h-source.html#l00038">p3CMSG_RKDIERR</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3crypto_8h-source.html#l00022">p3KSIZE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00024">p3KSIZE_AES256</a>, <a class="el" href="p3crypto_8h-source.html#l00021">p3KTYPE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00023">p3KTYPE_AES256</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>, <a class="el" href="p3ksession_8h-source.html#l00142">p3PSS_KTYPE</a>, <a class="el" href="p3ksession_8h-source.html#l00144">p3PSS_REKEY</a>, <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>, and <a class="el" href="p3ksession_8h-source.html#l00112">_p3session::sseq</a>.</p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8h_2cee32c0152fbe0cb76c0739d0c72246_cgraph.png" border="0" usemap="#p3ksession_8h_2cee32c0152fbe0cb76c0739d0c72246_cgraph_map" alt=""></center>
<map name="p3ksession_8h_2cee32c0152fbe0cb76c0739d0c72246_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#4a5a8ada1f7c67ee101fd8f2865b8436" title="build_vlen_message" alt="" coords="153,56,303,83"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="1007,208,1089,235"><area shape="rect" href="p3knet_8c.html#e42b8ad940d0e2e7f53e7e4096934645" title="p3send_control" alt="" coords="168,183,288,209"><area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="353,5,492,32"><area shape="rect" href="p3kcrypto_8c.html#e807e42de382b4967dcf61a94abf1d63" title="p3_encrypt" alt="" coords="377,208,468,235"><area shape="rect" href="p3linux_8c.html#61e0f4c4c3ee65ef0c0c47c5766d25fc" title="p3net_utils" alt="" coords="377,259,468,285"><area shape="rect" href="aes_8c.html#0773743fae8155fec8bf75c087531364" title="DoAES" alt="" coords="604,259,668,285"><area shape="rect" href="merrors_8c.html#e0fbf1c8cf3bc5beb2c222ef6fb403e2" title="MERROR_lookUpErrorCode" alt="" coords="541,309,731,336"><area shape="rect" href="aes_8h.html#b00b50ef06bf8b54ce973618804586e2" title="AESALGO_blockDecrypt" alt="" coords="779,360,952,387"><area shape="rect" href="aes_8h.html#5c1fa1647ea06de25b72db0239129de6" title="AESALGO_blockEncrypt" alt="" coords="780,309,951,336"><area shape="rect" href="aesalgo_8c.html#4c719df4534cebdf4a32e36b2baeeaf8" title="aesDecrypt" alt="" coords="1001,360,1095,387"><area shape="rect" href="aesalgo_8c.html#ab1010e729d5c019e6ef9e4dd55a3b96" title="aesEncrypt" alt="" coords="1003,309,1093,336"></map>
</div>

</div>
</div><p>
<a class="anchor" name="52262f83863e788f79c32917699172be"></a><!-- doxytag: member="p3ksession.h::rekey_test_sec" ref="52262f83863e788f79c32917699172be" args="(unsigned char *message, int size, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rekey_test_sec           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>rekey_test_sec</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Receive a message from the primary, reverse it and resend it.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>message: The message from the primary</li><li>size: The size of the message</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error </li></ul>
</li></ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="11bf297973fd2df2fb5da58abc220f3e"></a><!-- doxytag: member="p3ksession.h::heartbeat_query" ref="11bf297973fd2df2fb5da58abc220f3e" args="(unsigned int time, unsigned int seqnum, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int heartbeat_query           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>seqnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>heartbeat_query</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Handle a heartbeat query message from a primary.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>time: The P3 time that the message was sent</li><li>seqnum: The sequence number of the query</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error </li></ul>
</li></ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00438">parse_ctl_message()</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="f01e1812f2bb3a71e6bdf3a19a4120f8"></a><!-- doxytag: member="p3ksession.h::p3sess" ref="f01e1812f2bb3a71e6bdf3a19a4120f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3session.html">p3session</a>* <a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Sep 24 10:44:30 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
