<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Velocite Systems Protected Point to Point Solution: p3knet.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>p3knet.h</h1><a href="p3knet_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="preprocessor">#ifndef _p3kNET_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#define _p3kNET_H</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="comment">/*****  INCLUDE FILES *****/</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#include "<a class="code" href="p3kbase_8h.html">p3kbase.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include "<a class="code" href="p3ksession_8h.html">p3ksession.h</a>"</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="comment">/*****  CONSTANTS  *****/</span>
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="p3knet_8h.html#12418b6b438fdcdce936f274c5fac73e">00018</a> <span class="preprocessor">#define p3PKTS_NOMOD    0x00    </span>
<a name="l00019"></a><a class="code" href="p3knet_8h.html#ea5e25a22feb2d5ccccb1d09d7efa8a6">00019</a> <span class="preprocessor">#define p3PKTS_ADDHDR   0x01    </span>
<a name="l00020"></a><a class="code" href="p3knet_8h.html#324dde31b5ad72d07a4d82576db3be42">00020</a> <span class="preprocessor">#define p3PKTS_RMVHDR   0x02    </span>
<a name="l00021"></a><a class="code" href="p3knet_8h.html#138e28335249b56be70ec84c86fdba7b">00021</a> <span class="preprocessor">#define p3PKTS_CONTROL  0x04    </span>
<a name="l00022"></a><a class="code" href="p3knet_8h.html#651cc9599def7abf0c9b8f784e4e2589">00022</a> <span class="preprocessor">#define p3PKTS_RAWSOCK  0x08    </span>
<a name="l00023"></a><a class="code" href="p3knet_8h.html#06937a9194c7fe3485f61c9427c1a07e">00023</a> <span class="preprocessor">#define p3PKTS_CHKSUM   0x10    </span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="comment">/* Network utility function types */</span>
<a name="l00026"></a><a class="code" href="p3knet_8h.html#11277fc26334bc7c2d920bac2d35bef6">00026</a> <span class="preprocessor">#define p3TCP_CHECK     1   </span>
<a name="l00027"></a><a class="code" href="p3knet_8h.html#5a754675d76fae7b77c9f64678144e37">00027</a> <span class="preprocessor">#define p3TCP_CHECK_ADD 2   </span>
<a name="l00028"></a><a class="code" href="p3knet_8h.html#516e2e3c91b210741721c4db0917817b">00028</a> <span class="preprocessor">#define p3GET_MTU       3   </span>
<a name="l00029"></a><a class="code" href="p3knet_8h.html#3f3fb6b85c2d89481dbaf58a85a4a5ef">00029</a> <span class="preprocessor">#define p3SEND_CTL      4   </span>
<a name="l00031"></a><a class="code" href="p3knet_8h.html#da9ebd6febf4addfa2eaa0ef1dae6cde">00031</a> <span class="preprocessor">#define p3IP4_ID        4   </span>
<a name="l00032"></a><a class="code" href="p3knet_8h.html#a252ad5ee8a54a28b25907b08facb89a">00032</a> <span class="preprocessor">#define p3IP4_SADDR     12  </span>
<a name="l00033"></a><a class="code" href="p3knet_8h.html#a670226bc2558cac0e89411f9cf7bf07">00033</a> <span class="preprocessor">#define p3IP4_DADDR     16  </span>
<a name="l00035"></a><a class="code" href="p3knet_8h.html#b3e0ec26ce4f3823b098735e3a6cfc44">00035</a> <span class="preprocessor">#define p3MSS           536 </span>
<a name="l00036"></a><a class="code" href="p3knet_8h.html#1bbadecc123741b01726f49674112c08">00036</a> <span class="preprocessor">#define p3EXTRA_V4      128 </span>
<a name="l00037"></a><a class="code" href="p3knet_8h.html#014a24c9be04290b9d79a566173a0599">00037</a> <span class="preprocessor">#define p3MSS_V4        p3MSS + p3EXTRA_V4  </span>
<a name="l00038"></a><a class="code" href="p3knet_8h.html#7c243ece9ccfe0d4b70f20e1c4e81a30">00038</a> <span class="preprocessor">#define p3EXTRA_V6      148 </span>
<a name="l00039"></a><a class="code" href="p3knet_8h.html#1ee293725b0d49e0fb622f7ebd58f4af">00039</a> <span class="preprocessor">#define p3MSS_V6        p3MSS + p3EXTRA_V6  </span>
<a name="l00041"></a>00041 <span class="preprocessor"></span><span class="comment">/*****  DATA DEFINITIONS  *****/</span>
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="p3knet_8h.html#461272c2dc749c8d1083390d51e9d617">00043</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__p3route.html">_p3route</a> <a class="code" href="struct__p3route.html">p3route</a>;
<a name="l00044"></a><a class="code" href="p3knet_8h.html#fde6196c28f8fb25461fc434a8374e40">00044</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__p3net.html">_p3net</a> <a class="code" href="struct__p3net.html">p3net</a>;
<a name="l00045"></a><a class="code" href="p3knet_8h.html#004552a0e2c2e9846b0a3303ab69f706">00045</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__p3packet.html">_p3packet</a> <a class="code" href="struct__p3packet.html">p3packet</a>;
<a name="l00046"></a>00046 
<a name="l00055"></a><a class="code" href="struct__p3route.html">00055</a> <span class="keyword">struct </span><a class="code" href="struct__p3route.html">_p3route</a> {
<a name="l00056"></a><a class="code" href="struct__p3route.html#3e40ff1a6f3397be8e0985bd02e85ad8">00056</a>     <a class="code" href="struct__p3net.html">p3net</a>           **<a class="code" href="struct__p3route.html#3e40ff1a6f3397be8e0985bd02e85ad8">nets</a>;     <span class="comment">/*&lt;&lt; P3 networks */</span>
<a name="l00057"></a><a class="code" href="struct__p3route.html#b379e2c807c5814ec5580e74fa2c415b">00057</a>     <span class="keywordtype">int</span>             <a class="code" href="struct__p3route.html#b379e2c807c5814ec5580e74fa2c415b">netsz</a>;      <span class="comment">/*&lt;&lt; Number of networks in table */</span>
<a name="l00058"></a><a class="code" href="p3knet_8h.html#f33909afec94510a2ad20c18208190af">00058</a> <span class="preprocessor">#define P3MAXROUTE  8</span>
<a name="l00059"></a><a class="code" href="struct__p3route.html#e973900f5f79195ad5b93a608f33bdb0">00059</a> <span class="preprocessor"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="struct__p3route.html#e973900f5f79195ad5b93a608f33bdb0">flag</a>;
<a name="l00060"></a>00060 <span class="comment">//reserve p3IP_TYPE 0x30000000  /* IP version field */</span>
<a name="l00061"></a>00061 };
<a name="l00062"></a>00062 
<a name="l00071"></a>00071 <span class="keyword">struct </span><a class="code" href="struct__p3net.html">_p3net</a> {
<a name="l00072"></a>00072     <span class="keyword">union </span>{
<a name="l00073"></a>00073         <span class="keyword">struct </span>in_addr  v4;
<a name="l00074"></a>00074         <span class="keyword">struct </span>in6_addr v6;
<a name="l00075"></a>00075     } <a class="code" href="struct__p3net.html#31bd369b936ae785a5b03cb8f6d9ba0a">net</a>;                          <span class="comment">/*&lt;&lt; Subnet address (IPv4 or IPv6) */</span>
<a name="l00076"></a><a class="code" href="struct__p3net.html#5850efb0e783cf89d873a8a36d12d405">00076</a>     <span class="keyword">struct </span>in_addr      <a class="code" href="struct__p3net.html#be25dc9f35a0bfab971f90d4d700edc8">mask</a>;       <span class="comment">/*&lt;&lt; Subnet mask (IPv4) */</span>
<a name="l00077"></a><a class="code" href="struct__p3net.html#5ced8fd09ffd8ce6f915505429bf3acb">00077</a>     <a class="code" href="struct__p3host.html">p3host</a>              *<a class="code" href="struct__p3net.html#5ced8fd09ffd8ce6f915505429bf3acb">host</a>;      <span class="comment">/*&lt;&lt; Remote host entry for route */</span>
<a name="l00078"></a>00078 };
<a name="l00079"></a>00079 
<a name="l00088"></a><a class="code" href="struct__p3packet.html">00088</a> <span class="keyword">struct </span><a class="code" href="struct__p3packet.html">_p3packet</a> {
<a name="l00089"></a><a class="code" href="struct__p3packet.html#738743412419fdabb88fbdd62d8eb968">00089</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   *<a class="code" href="struct__p3packet.html#738743412419fdabb88fbdd62d8eb968">packet</a>;    <span class="comment">/*&lt;&lt; Packet data, including headers */</span>
<a name="l00090"></a><a class="code" href="struct__p3packet.html#2cf851d78e69afb912432b296eab3b27">00090</a>     <a class="code" href="struct__p3host.html">p3host</a>          *<a class="code" href="struct__p3packet.html#2cf851d78e69afb912432b296eab3b27">host</a>;      <span class="comment">/*&lt;&lt; Host associated with packet */</span>
<a name="l00091"></a><a class="code" href="struct__p3packet.html#0f83ac99882de16106e5382b8e3aad36">00091</a>     <span class="keywordtype">int</span>             <a class="code" href="struct__p3packet.html#0f83ac99882de16106e5382b8e3aad36">netdata</a>;    <span class="comment">/*&lt;&lt; Return numeric data from net_utils function */</span>
<a name="l00092"></a><a class="code" href="struct__p3packet.html#d17cf0cf124179be93c33934e6141064">00092</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="struct__p3packet.html#d17cf0cf124179be93c33934e6141064">flag</a>;
<a name="l00093"></a><a class="code" href="p3knet_8h.html#51c2a0d7c585283910d74e62e8ca537d">00093</a> <span class="preprocessor">#define p3PKT_SIZE  0x0000ffff  </span><span class="comment">/* Size of packet data */</span>
<a name="l00094"></a><a class="code" href="p3knet_8h.html#143508142f19f1bdc4940347512c6484">00094</a> <span class="preprocessor">#define p3PKT_P3SRC 0x00010000  </span><span class="comment">/* Source address is P3 host */</span>
<a name="l00095"></a><a class="code" href="p3knet_8h.html#e955037f864780e67ed84ef55e342f36">00095</a> <span class="preprocessor">#define p3PKT_P3DST 0x00020000  </span><span class="comment">/* Destination address is P3 subnet */</span>
<a name="l00096"></a>00096 };
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="comment">/*****  MACROS  *****/</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="comment">/*****  PROTOTYPES  *****/</span>
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="p3knet_8c.html#ebcb19f32b96fdb0c580e57088828b4a">init_p3net</a>(<span class="keywordtype">void</span>);
<a name="l00103"></a>00103 <span class="keywordtype">int</span> <a class="code" href="p3knet_8c.html#477c7725aa7c5d922a3e6f4cf59c419f">build_p3table</a>(<a class="code" href="struct__p3net.html">p3net</a> *net, <span class="keywordtype">int</span> ipver);
<a name="l00104"></a>00104 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="p3knet_8c.html#f447819ecfcd4e69349a017e7d8a13cd">packet_handler</a>(<a class="code" href="struct__p3packet.html">p3packet</a> *pkt, <span class="keywordtype">void</span> *p3sys_net);
<a name="l00105"></a>00105 <span class="keywordtype">void</span> <a class="code" href="p3knet_8c.html#7d8e3f552c7187072e555bf504fec819">p3_lookup</a>(<a class="code" href="struct__p3packet.html">p3packet</a> *pkt);
<a name="l00106"></a>00106 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="p3knet_8h.html#aea152b37791da68ffdf7029305935dc">encrypt_packet</a>(<a class="code" href="struct__p3session.html">p3session</a> *p3sess, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *packet);
<a name="l00107"></a>00107 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="p3knet_8h.html#70f83668afef962d8ca62ab415899cc0">decrypt_packet</a>(<a class="code" href="struct__p3session.html">p3session</a> *p3sess, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *packet);
<a name="l00108"></a>00108 <span class="keywordtype">int</span> <a class="code" href="p3knet_8c.html#e42b8ad940d0e2e7f53e7e4096934645">p3send_control</a>(<a class="code" href="struct__p3session.html">p3session</a> *session, <a class="code" href="struct__p3ctlmsg.html">p3ctlmsg</a> *cmsg);
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">/*****  EXTERNAL DEFINITIONS  *****/</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="preprocessor">#ifndef _p3NET_C</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="struct__p3route.html">p3route</a> *<a class="code" href="p3knet_8c.html#c23de86e4ad7c3a7fa624b9a8c1c2b56">ipv4route</a>, *<a class="code" href="p3knet_8c.html#6d75ba34434af0d67deb1e2352752556">ipv6route</a>;
<a name="l00114"></a>00114 <span class="keyword">extern</span> <a class="code" href="struct__p3host.html">p3host</a> *<a class="code" href="p3knet_8c.html#b0ef672ac9ffe9efaff389eae79bbcd9">p3hosts</a>;
<a name="l00115"></a>00115 <span class="preprocessor">#endif</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="preprocessor">#endif </span><span class="comment">/* _p3kNET_H */</span>
<a name="l00119"></a>00119 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Sep 24 10:44:24 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
