<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Velocite Systems Protected Point to Point Solution: p3ksession.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>p3ksession.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>Protected Point to Point primary session</h3>
<p>
Copyright (C) Velocite 2010<p>
The primary user session manages communications with secondary P3 systems. 
<p>
<code>#include &quot;<a class="el" href="p3knet_8h-source.html">p3knet.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for p3ksession.c:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8c__incl.png" border="0" usemap="#p3ksession.c_map" alt=""></center>
<map name="p3ksession.c_map">
<area shape="rect" href="p3knet_8h.html" title="p3knet.h" alt="" coords="787,84,864,111"><area shape="rect" href="p3kbase_8h.html" title="p3kbase.h" alt="" coords="737,239,825,265"><area shape="rect" href="p3ksession_8h.html" title="p3ksession.h" alt="" coords="819,161,923,188"><area shape="rect" href="p3linux_8h.html" title="p3linux.h" alt="" coords="800,316,877,343"><area shape="rect" href="p3kcrypto_8h.html" title="p3kcrypto.h" alt="" coords="849,239,945,265"></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8c.html#67c0368da866a1d40d64c5c5f62c0da5">init_session</a> (<a class="el" href="struct__p3host.html">p3host</a> *<a class="el" href="planning_8txt.html#67db5ca565845ab69d176efade637c1e">host</a>, void *srcaddr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8c.html#0afcca28441ee6077ad65ec7cbd04501">build_flag_message</a> (int type, unsigned int flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8c.html#4a5a8ada1f7c67ee101fd8f2865b8436">build_vlen_message</a> (int type, unsigned int flag, unsigned char *message, int len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8c.html#61826257e17f2923e2300451ceb58d58">build_heartbeat_message</a> (int type, unsigned int sequence)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265">build_ctl_message</a> (int type, unsigned char *message, int len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8c.html#ccd384ee6eff17fb46a44bcd0a2e8ed9">parse_ctl_message</a> (<a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *ctlmsg, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3ksession_8h.html#f01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">time_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3ksession_8c.html#d60227b1966bccfd584bbdc6d4955f9c">midnight</a> = 0</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="67c0368da866a1d40d64c5c5f62c0da5"></a><!-- doxytag: member="p3ksession.c::init_session" ref="67c0368da866a1d40d64c5c5f62c0da5" args="(p3host *host, void *srcaddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_session           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3host.html">p3host</a> *&nbsp;</td>
          <td class="paramname"> <em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>srcaddr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>init_session</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Initialize a session. This allocates a new session structure and all of its fields.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>host: The host structure for the session to be initialized.</li><li>srcaddr: The local host address. Because it can be either IPv4 or IPv6, it is passed as a void pointer.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>None. </li></ul>
</dd></dl>

<p>References <a class="el" href="struct__p3host.html#1d30157fd8630192bcadb18c25dacd9f">_p3host::addr</a>, <a class="el" href="p3kcrypto_8h-source.html#l00099">_p3keymgmt::cnewkey</a>, <a class="el" href="p3kcrypto_8h-source.html#l00098">_p3keymgmt::dnewkey</a>, <a class="el" href="p3net_8h-source.html#l00046">_p3host::flag</a>, <a class="el" href="p3ksession_8h-source.html#l00141">_p3session::flag</a>, <a class="el" href="p3ksession_8h-source.html#l00106">_p3session::keymgmt</a>, <a class="el" href="p3ksession_8h-source.html#l00124">_p3session::lock</a>, <a class="el" href="p3ksession_8h-source.html#l00134">_p3session::p3hdr</a>, <a class="el" href="p3net_8h-source.html#l00048">p3HST_IPV4</a>, <a class="el" href="p3net_8h-source.html#l00049">p3HST_IPV6</a>, <a class="el" href="p3ksession_8h-source.html#l00088">p3HST_IPVER</a>, <a class="el" href="p3net_8h-source.html#l00052">p3HST_KTSHF</a>, <a class="el" href="p3net_8h-source.html#l00051">p3HST_KTYPE</a>, <a class="el" href="p3crypto_8h-source.html#l00022">p3KSIZE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00024">p3KSIZE_AES256</a>, <a class="el" href="p3crypto_8h-source.html#l00021">p3KTYPE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00023">p3KTYPE_AES256</a>, <a class="el" href="p3linux_8h-source.html#l00069">p3lock_init</a>, <a class="el" href="p3ksession_8h-source.html#l00142">p3PSS_KTYPE</a>, <a class="el" href="p3ksession_8h-source.html#l00077">_p3host::session</a>, <a class="el" href="p3crypto_8h-source.html#l00041">_p3key::size</a>, <a class="el" href="p3ksession_8h-source.html#l00112">_p3session::sseq</a>, and <a class="el" href="p3net_8h-source.html#l00037">_p3host::v4</a>.</p>

<p>Referenced by <a class="el" href="p3kprimary_8c-source.html#l00134">parse_p3data()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0afcca28441ee6077ad65ec7cbd04501"></a><!-- doxytag: member="p3ksession.c::build_flag_message" ref="0afcca28441ee6077ad65ec7cbd04501" args="(int type, unsigned int flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_flag_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_flag_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build a control message that only contains a flag.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>flag: The flag settings</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>unsigned char *: The encrypted message or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00378">build_ctl_message()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8c_0afcca28441ee6077ad65ec7cbd04501_cgraph.png" border="0" usemap="#p3ksession_8c_0afcca28441ee6077ad65ec7cbd04501_cgraph_map" alt=""></center>
<map name="p3ksession_8c_0afcca28441ee6077ad65ec7cbd04501_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="204,5,343,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4a5a8ada1f7c67ee101fd8f2865b8436"></a><!-- doxytag: member="p3ksession.c::build_vlen_message" ref="4a5a8ada1f7c67ee101fd8f2865b8436" args="(int type, unsigned int flag, unsigned char *message, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_vlen_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_vlen_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build a varilable length control message. All variable length messages except Rekey Test include a flag.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>flag: The flag settings</li><li>message: The variable length message</li><li>len: The length of the message</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>unsigned char *: The encrypted message or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00378">build_ctl_message()</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3ksession_8h-source.html#l00034">p3CMSG_REKEY</a>, <a class="el" href="p3ksession_8h-source.html#l00041">p3CMSG_REKEY_TEST</a>, <a class="el" href="p3ksession_8h-source.html#l00024">p3CMSG_SET_KEY_ARRAY</a>, <a class="el" href="p3ksession_8h-source.html#l00044">p3CMSG_STATUS_REQ</a>, <a class="el" href="p3ksession_8h-source.html#l00045">p3CMSG_STATUS_RESP</a>, <a class="el" href="p3ksession_8h-source.html#l00046">p3CMSG_UPDATE_INFO</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3ksession_8h-source.html#l00021">p3MAX_MSG_SZ</a>, and <a class="el" href="p3base_8h-source.html#l00047">p3MSG_ERR</a>.</p>

<p>Referenced by <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>, and <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8c_4a5a8ada1f7c67ee101fd8f2865b8436_cgraph.png" border="0" usemap="#p3ksession_8c_4a5a8ada1f7c67ee101fd8f2865b8436_cgraph_map" alt=""></center>
<map name="p3ksession_8c_4a5a8ada1f7c67ee101fd8f2865b8436_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="207,5,345,32"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="235,56,317,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="61826257e17f2923e2300451ceb58d58"></a><!-- doxytag: member="p3ksession.c::build_heartbeat_message" ref="61826257e17f2923e2300451ceb58d58" args="(int type, unsigned int sequence)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_heartbeat_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>sequence</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_heartbeat_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build a heartbeat query or answer message.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>sequence: The heartbeat sequence number</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>unsigned char *: The encrypted message or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8c-source.html#l00378">build_ctl_message()</a>, <a class="el" href="p3ksession_8c-source.html#l00019">midnight</a>, and <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8c_61826257e17f2923e2300451ceb58d58_cgraph.png" border="0" usemap="#p3ksession_8c_61826257e17f2923e2300451ceb58d58_cgraph_map" alt=""></center>
<map name="p3ksession_8c_61826257e17f2923e2300451ceb58d58_cgraph_map">
<area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="244,5,383,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="594393343fee6c7a0fc9c6d7fc6ba265"></a><!-- doxytag: member="p3ksession.c::build_ctl_message" ref="594393343fee6c7a0fc9c6d7fc6ba265" args="(int type, unsigned char *message, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a>* build_ctl_message           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>build_ctl_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Build the requested control message and encrypt it. This is called by individual control message build functions.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li><li>message: Message data</li><li>len: Length of message data</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>p3ctlmsg *: The encrypted message structure or NULL if there is an error. </li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8h-source.html#l00163">_p3ctlmsg::len</a>, <a class="el" href="p3ksession_8h-source.html#l00162">_p3ctlmsg::message</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, and <a class="el" href="p3base_8h-source.html#l00185">p3calloc</a>.</p>

<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00186">build_flag_message()</a>, <a class="el" href="p3ksession_8c-source.html#l00322">build_heartbeat_message()</a>, and <a class="el" href="p3ksession_8c-source.html#l00215">build_vlen_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ccd384ee6eff17fb46a44bcd0a2e8ed9"></a><!-- doxytag: member="p3ksession.c::parse_ctl_message" ref="ccd384ee6eff17fb46a44bcd0a2e8ed9" args="(p3ctlmsg *ctlmsg, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_ctl_message           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3ctlmsg.html">p3ctlmsg</a> *&nbsp;</td>
          <td class="paramname"> <em>ctlmsg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>parse_ctl_message</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Parse a message and call the function to handle it. The format of the Control Messages is: <pre>
 | 4 octets | 1 octet | Variable length |
 | Size     | Command | Data            |
   where the fields are:
 Size:  The total size of the message, including the size field itself
 Command:  An 8-bit number
 Data:  The data, if any, associated with the command
 </pre></dd></dl>
The handler functions must be defined in the primary or secondary session handler, depending on which receives the message. The message handling code is only compiled if the P3 system is the receiver. All message handling is compiled for the Primary Plus Secondary P3 system.<p>
See the P3 System Specification for details on the commands.<p>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>ctlmsg: The message structure, including the buffer with the size field.</li><li>p3sess: The session structure for the current P3 session.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error</li><li>&gt;0 = Status from remote P3 system </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3kpri__session_8c-source.html#l00185">heartbeat_answer()</a>, <a class="el" href="p3ksec__session_8c-source.html#l00268">heartbeat_query()</a>, <a class="el" href="p3kpri__session_8c-source.html#l00072">key_array_error()</a>, <a class="el" href="p3ksession_8h-source.html#l00163">_p3ctlmsg::len</a>, <a class="el" href="p3ksession_8h-source.html#l00162">_p3ctlmsg::message</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3primary_8c-source.html#l00074">p3buf</a>, <a class="el" href="p3ksession_8h-source.html#l00025">p3CMSG_ACK_KEY_ARRAY</a>, <a class="el" href="p3ksession_8h-source.html#l00057">p3CMSG_ACK_SHUTDOWN</a>, <a class="el" href="p3ksession_8h-source.html#l00049">p3CMSG_ACK_UPDATE</a>, <a class="el" href="p3ksession_8h-source.html#l00028">p3CMSG_AKERR</a>, <a class="el" href="p3ksession_8h-source.html#l00043">p3CMSG_HRTBEAT_ANSWER</a>, <a class="el" href="p3ksession_8h-source.html#l00042">p3CMSG_HRTBEAT_QUERY</a>, <a class="el" href="p3ksession_8h-source.html#l00031">p3CMSG_KRCIDX</a>, <a class="el" href="p3ksession_8h-source.html#l00032">p3CMSG_KRDIDX</a>, <a class="el" href="p3ksession_8h-source.html#l00023">p3CMSG_KTYPE</a>, <a class="el" href="p3ksession_8h-source.html#l00034">p3CMSG_REKEY</a>, <a class="el" href="p3ksession_8h-source.html#l00041">p3CMSG_REKEY_TEST</a>, <a class="el" href="p3ksession_8h-source.html#l00030">p3CMSG_REPLACE_KEY</a>, <a class="el" href="p3ksession_8h-source.html#l00024">p3CMSG_SET_KEY_ARRAY</a>, <a class="el" href="p3ksession_8h-source.html#l00054">p3CMSG_SHUTDOWN</a>, <a class="el" href="p3ksession_8h-source.html#l00044">p3CMSG_STATUS_REQ</a>, <a class="el" href="p3ksession_8h-source.html#l00045">p3CMSG_STATUS_RESP</a>, <a class="el" href="p3ksession_8h-source.html#l00046">p3CMSG_UPDATE_INFO</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3crypto_8h-source.html#l00022">p3KSIZE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00024">p3KSIZE_AES256</a>, <a class="el" href="p3crypto_8h-source.html#l00021">p3KTYPE_AES128</a>, <a class="el" href="p3crypto_8h-source.html#l00023">p3KTYPE_AES256</a>, <a class="el" href="p3base_8h-source.html#l00051">p3MSG_DEBUG</a>, <a class="el" href="p3kpri__session_8c-source.html#l00096">rekey_session()</a>, <a class="el" href="p3kpri__session_8c-source.html#l00159">rekey_test_pri()</a>, <a class="el" href="p3ksec__session_8c-source.html#l00241">rekey_test_sec()</a>, <a class="el" href="p3ksec__session_8c-source.html#l00103">replace_key()</a>, and <a class="el" href="p3ksec__session_8c-source.html#l00075">set_key_array()</a>.</p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3ksession_8c_ccd384ee6eff17fb46a44bcd0a2e8ed9_cgraph.png" border="0" usemap="#p3ksession_8c_ccd384ee6eff17fb46a44bcd0a2e8ed9_cgraph_map" alt=""></center>
<map name="p3ksession_8c_ccd384ee6eff17fb46a44bcd0a2e8ed9_cgraph_map">
<area shape="rect" href="p3kpri__session_8c.html#9bb8f1ec82fa429ae11637caa19bf1f5" title="heartbeat_answer" alt="" coords="200,5,336,32"><area shape="rect" href="p3ksec__session_8c.html#11bf297973fd2df2fb5da58abc220f3e" title="heartbeat_query" alt="" coords="204,56,332,83"><area shape="rect" href="p3kpri__session_8c.html#ca3d48d1ee35eb9d228250606f4394c3" title="key_array_error" alt="" coords="208,107,328,133"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="1239,461,1321,488"><area shape="rect" href="p3kpri__session_8c.html#52a21487fa0fd6103b29853aa2152f58" title="rekey_session" alt="" coords="212,309,324,336"><area shape="rect" href="p3kpri__session_8c.html#1e7a96342264a49601111f552b6b0219" title="rekey_test_pri" alt="" coords="404,461,516,488"><area shape="rect" href="p3ksec__session_8c.html#52262f83863e788f79c32917699172be" title="rekey_test_sec" alt="" coords="209,360,327,387"><area shape="rect" href="p3ksec__session_8c.html#2cee32c0152fbe0cb76c0739d0c72246" title="replace_key" alt="" coords="220,208,316,235"><area shape="rect" href="p3ksec__session_8c.html#6630ebbd7b47ed8338e449d26f9958ec" title="set_key_array" alt="" coords="213,411,323,437"><area shape="rect" href="p3ksession_8c.html#4a5a8ada1f7c67ee101fd8f2865b8436" title="build_vlen_message" alt="" coords="385,259,535,285"><area shape="rect" href="p3knet_8c.html#e42b8ad940d0e2e7f53e7e4096934645" title="p3send_control" alt="" coords="400,385,520,412"><area shape="rect" href="p3ksession_8c.html#594393343fee6c7a0fc9c6d7fc6ba265" title="build_ctl_message" alt="" coords="585,259,724,285"><area shape="rect" href="p3kcrypto_8c.html#e807e42de382b4967dcf61a94abf1d63" title="p3_encrypt" alt="" coords="609,461,700,488"><area shape="rect" href="p3linux_8c.html#61e0f4c4c3ee65ef0c0c47c5766d25fc" title="p3net_utils" alt="" coords="609,411,700,437"><area shape="rect" href="aes_8c.html#0773743fae8155fec8bf75c087531364" title="DoAES" alt="" coords="836,588,900,615"><area shape="rect" href="merrors_8c.html#e0fbf1c8cf3bc5beb2c222ef6fb403e2" title="MERROR_lookUpErrorCode" alt="" coords="773,411,963,437"><area shape="rect" href="aes_8h.html#b00b50ef06bf8b54ce973618804586e2" title="AESALGO_blockDecrypt" alt="" coords="1011,664,1184,691"><area shape="rect" href="aes_8h.html#5c1fa1647ea06de25b72db0239129de6" title="AESALGO_blockEncrypt" alt="" coords="1012,613,1183,640"><area shape="rect" href="aesalgo_8c.html#4c719df4534cebdf4a32e36b2baeeaf8" title="aesDecrypt" alt="" coords="1233,664,1327,691"><area shape="rect" href="aesalgo_8c.html#ab1010e729d5c019e6ef9e4dd55a3b96" title="aesEncrypt" alt="" coords="1235,613,1325,640"></map>
</div>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="d60227b1966bccfd584bbdc6d4955f9c"></a><!-- doxytag: member="p3ksession.c::midnight" ref="d60227b1966bccfd584bbdc6d4955f9c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t <a class="el" href="p3ksession_8c.html#d60227b1966bccfd584bbdc6d4955f9c">midnight</a> = 0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The time_t equivalent of the previous midnight 
<p>Referenced by <a class="el" href="p3ksession_8c-source.html#l00322">build_heartbeat_message()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Sep 24 10:44:30 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
