<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Velocite Systems Protected Point to Point Solution: p3kprimary.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>p3kprimary.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>Protected Point to Point product primary main functions header file</h3>
<p>
Copyright (C) Velocite 2010 
<p>
<code>#include &quot;<a class="el" href="p3kbase_8h-source.html">p3kbase.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="p3knet_8h-source.html">p3knet.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for p3kprimary.h:</div>
<div class="dynsection">
<p><center><img src="p3kprimary_8h__incl.png" border="0" usemap="#p3kprimary.h_map" alt=""></center>
<map name="p3kprimary.h_map">
<area shape="rect" href="p3kbase_8h.html" title="p3kbase.h" alt="" coords="737,239,825,265"><area shape="rect" href="p3knet_8h.html" title="p3knet.h" alt="" coords="781,84,859,111"><area shape="rect" href="p3linux_8h.html" title="p3linux.h" alt="" coords="800,316,877,343"><area shape="rect" href="p3ksession_8h.html" title="p3ksession.h" alt="" coords="832,161,936,188"><area shape="rect" href="p3kcrypto_8h.html" title="p3kcrypto.h" alt="" coords="849,239,945,265"></map>
</div>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="p3kprimary_8h__dep__incl.png" border="0" usemap="#p3kprimary.hdep_map" alt=""></center>
<map name="p3kprimary.hdep_map">
<area shape="rect" href="p3kpri__session_8c.html" title="p3kpri_session.c" alt="" coords="5,82,125,106"><area shape="rect" href="p3kprimary_8c.html" title="p3kprimary.c" alt="" coords="149,82,245,106"><area shape="rect" href="p3kprimaryplus_8h.html" title="p3kprimaryplus.h" alt="" coords="269,82,389,106"><area shape="rect" href="p3kprimaryplus_8c.html" title="p3kprimaryplus.c" alt="" coords="269,156,389,180"></map>
</div>

<p>
<a href="p3kprimary_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3pri__main.html">_p3pri_main</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#ba1ab4ede4a62468a90f0691a8a00c76">p3MIN_IOCTL_SIZE</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#4c78e07370fff43656cc779937471d15">p3IOCMD_PID</a>&nbsp;&nbsp;&nbsp;&quot;PID&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#1bd0de3b5abbf705059a061de7fa5f00">p3RMT_ARSZ</a>&nbsp;&nbsp;&nbsp;256</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#934d74f9e69e748a619e05661aff826b">p3PRI_NINFO</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct <a class="el" href="struct__p3pri__main.html">_p3pri_main</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#c3596c5a7e6b03666dbb9f8e9af849a7">p3pri_main</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef struct _p3config&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#13547808d1c537d37c5d94060b8c7f90">p3config</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#1df38194b0c465f332d16d0a9055f4b5">init_primary</a> (unsigned char *ramdisk)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#15ca37bcc4730f5931238ec7bccf0ff0">parse_p3data</a> (unsigned char *buffer, int size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#03d79b6ee63bc63762cdea330216b2d9">start_rekeying</a> (<a class="el" href="struct__p3session.html">p3session</a> *session)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct__p3pri__main.html">p3pri_main</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3kprimary_8h.html#208680be731447ccb8f72df566ed7eba">primain</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="ba1ab4ede4a62468a90f0691a8a00c76"></a><!-- doxytag: member="p3kprimary.h::p3MIN_IOCTL_SIZE" ref="ba1ab4ede4a62468a90f0691a8a00c76" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3MIN_IOCTL_SIZE&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="4c78e07370fff43656cc779937471d15"></a><!-- doxytag: member="p3kprimary.h::p3IOCMD_PID" ref="4c78e07370fff43656cc779937471d15" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3IOCMD_PID&nbsp;&nbsp;&nbsp;&quot;PID&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="1bd0de3b5abbf705059a061de7fa5f00"></a><!-- doxytag: member="p3kprimary.h::p3RMT_ARSZ" ref="1bd0de3b5abbf705059a061de7fa5f00" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3RMT_ARSZ&nbsp;&nbsp;&nbsp;256          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Referenced by <a class="el" href="p3kprimary_8c-source.html#l00068">init_primary()</a>.</p>

</div>
</div><p>
<a class="anchor" name="934d74f9e69e748a619e05661aff826b"></a><!-- doxytag: member="p3kprimary.h::p3PRI_NINFO" ref="934d74f9e69e748a619e05661aff826b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PRI_NINFO&nbsp;&nbsp;&nbsp;0x00000001          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Ignore informational messages 
</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="c3596c5a7e6b03666dbb9f8e9af849a7"></a><!-- doxytag: member="p3kprimary.h::p3pri_main" ref="c3596c5a7e6b03666dbb9f8e9af849a7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3pri__main.html">_p3pri_main</a> <a class="el" href="struct__p3pri__main.html">p3pri_main</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="13547808d1c537d37c5d94060b8c7f90"></a><!-- doxytag: member="p3kprimary.h::p3config" ref="13547808d1c537d37c5d94060b8c7f90" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct _p3config <a class="el" href="p3kprimary_8h.html#13547808d1c537d37c5d94060b8c7f90">p3config</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="1df38194b0c465f332d16d0a9055f4b5"></a><!-- doxytag: member="p3kprimary.h::init_primary" ref="1df38194b0c465f332d16d0a9055f4b5" args="(unsigned char *ramdisk)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_primary           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>ramdisk</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>init_p3primary</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Initialize the P3 Primary module by creating the basic structures for handling P3 primary connections.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>ramdisk: The location of the RAM disk area.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3kprimary_8h-source.html#l00040">_p3pri_main::array_size</a>, <a class="el" href="p3knet_8c-source.html#l00060">init_p3net()</a>, <a class="el" href="p3kprimary_8h-source.html#l00039">_p3pri_main::key_mgr</a>, <a class="el" href="p3kcrypto_8h-source.html#l00064">_p3key_mgr::key_serv</a>, <a class="el" href="p3kcrypto_8h-source.html#l00065">_p3key_mgr::lock</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3base_8h-source.html#l00185">p3calloc</a>, <a class="el" href="p3profile_8c-source.html#l00387">p3errmsg()</a>, <a class="el" href="p3linux_8h-source.html#l00069">p3lock_init</a>, <a class="el" href="p3base_8h-source.html#l00046">p3MSG_CRIT</a>, <a class="el" href="p3share_8h-source.html#l00058">p3PRI_PORT</a>, <a class="el" href="p3kprimary_8h-source.html#l00041">p3RMT_ARSZ</a>, and <a class="el" href="p3kprimary_8h-source.html#l00047">_p3pri_main::port</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3kprimary_8h_1df38194b0c465f332d16d0a9055f4b5_cgraph.png" border="0" usemap="#p3kprimary_8h_1df38194b0c465f332d16d0a9055f4b5_cgraph_map" alt=""></center>
<map name="p3kprimary_8h_1df38194b0c465f332d16d0a9055f4b5_cgraph_map">
<area shape="rect" href="p3knet_8c.html#ebcb19f32b96fdb0c580e57088828b4a" title="init_p3net" alt="" coords="151,5,233,32"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="284,31,367,57"></map>
</div>

</div>
</div><p>
<a class="anchor" name="15ca37bcc4730f5931238ec7bccf0ff0"></a><!-- doxytag: member="p3kprimary.h::parse_p3data" ref="15ca37bcc4730f5931238ec7bccf0ff0" args="(unsigned char *buffer, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_p3data           </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>parse_p3data</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Parse data sent from the P3 user space application in an ioctl command.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>buffer: The data to be parsed</li><li>size: The size of the data buffer</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Critical error</li><li>&gt;0 = Non-critical error</li></ul>
</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Function:</b></dt><dd>parse_p3data</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Parse the P3 Secondary configuration file.</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>buffer: The data to be parsed</li><li>size: The size of the data buffer</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Error</li><li>&gt;0 = Config does not exist, use defaults </li></ul>
</li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="03d79b6ee63bc63762cdea330216b2d9"></a><!-- doxytag: member="p3kprimary.h::start_rekeying" ref="03d79b6ee63bc63762cdea330216b2d9" args="(p3session *session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void start_rekeying           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Function:</b></dt><dd>start_rekeying</dd></dl>
<dl class="user" compact><dt><b>Description:</b></dt><dd>Start the rekeying control sequence</dd></dl>
<dl class="user" compact><dt><b>Inputs:</b></dt><dd><ul>
<li>p3sess: The remote P3 host session information</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li><li>&lt;0 = Critical error</li><li>&gt;0 = Non-critical error </li></ul>
</li></ul>
</dd></dl>

<p>References <a class="el" href="p3ksession_8h.html#82ba0db0ef7ddf7e28cc28fab0761aa3">build_newkey_message()</a>, <a class="el" href="p3ksession_8h-source.html#l00141">_p3session::flag</a>, <a class="el" href="p3kprimary_8h-source.html#l00039">_p3pri_main::key_mgr</a>, <a class="el" href="p3ksession_8h-source.html#l00124">_p3session::lock</a>, <a class="el" href="mdefs_8h-source.html#l00019">NULL</a>, <a class="el" href="p3linux_8h-source.html#l00072">p3lock</a>, <a class="el" href="p3ksession_8h-source.html#l00144">p3PSS_REKEY</a>, <a class="el" href="p3knet_8c-source.html#l00733">p3send_control()</a>, and <a class="el" href="p3linux_8h-source.html#l00075">p3unlock</a>.</p>

<p>Referenced by <a class="el" href="p3knet_8c-source.html#l00198">packet_handler()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="p3kprimary_8h_03d79b6ee63bc63762cdea330216b2d9_cgraph.png" border="0" usemap="#p3kprimary_8h_03d79b6ee63bc63762cdea330216b2d9_cgraph_map" alt=""></center>
<map name="p3kprimary_8h_03d79b6ee63bc63762cdea330216b2d9_cgraph_map">
<area shape="rect" href="p3ksession_8h.html#82ba0db0ef7ddf7e28cc28fab0761aa3" title="build_newkey_message" alt="" coords="167,5,337,32"><area shape="rect" href="p3knet_8c.html#e42b8ad940d0e2e7f53e7e4096934645" title="p3send_control" alt="" coords="192,56,312,83"><area shape="rect" href="p3kcrypto_8c.html#e807e42de382b4967dcf61a94abf1d63" title="p3_encrypt" alt="" coords="388,56,479,83"><area shape="rect" href="p3profile_8c.html#115044c21fee0be99499431a0d3cabdc" title="p3errmsg" alt="" coords="993,132,1076,159"><area shape="rect" href="p3linux_8c.html#61e0f4c4c3ee65ef0c0c47c5766d25fc" title="p3net_utils" alt="" coords="388,107,479,133"><area shape="rect" href="aes_8c.html#0773743fae8155fec8bf75c087531364" title="DoAES" alt="" coords="591,157,655,184"><area shape="rect" href="merrors_8c.html#e0fbf1c8cf3bc5beb2c222ef6fb403e2" title="MERROR_lookUpErrorCode" alt="" coords="528,31,717,57"><area shape="rect" href="aes_8h.html#b00b50ef06bf8b54ce973618804586e2" title="AESALGO_blockDecrypt" alt="" coords="765,233,939,260"><area shape="rect" href="aes_8h.html#5c1fa1647ea06de25b72db0239129de6" title="AESALGO_blockEncrypt" alt="" coords="767,183,937,209"><area shape="rect" href="aesalgo_8c.html#4c719df4534cebdf4a32e36b2baeeaf8" title="aesDecrypt" alt="" coords="988,233,1081,260"><area shape="rect" href="aesalgo_8c.html#ab1010e729d5c019e6ef9e4dd55a3b96" title="aesEncrypt" alt="" coords="989,183,1080,209"></map>
</div>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="208680be731447ccb8f72df566ed7eba"></a><!-- doxytag: member="p3kprimary.h::primain" ref="208680be731447ccb8f72df566ed7eba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3pri__main.html">p3pri_main</a>* <a class="el" href="p3kprimaryplus_8h.html#208680be731447ccb8f72df566ed7eba">primain</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The main primary structure<p>
The main primaryplus structure<p>
The main primary plus secondary structure 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Sep 24 10:44:29 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
