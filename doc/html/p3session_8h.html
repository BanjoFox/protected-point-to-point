<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Velocite Systems Protected Point to Point Solution: p3session.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>p3session.h File Reference</h1><code>#include &quot;<a class="el" href="p3base_8h_source.html">p3base.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="p3crypto_8h_source.html">p3crypto.h</a>&quot;</code><br/>
<code>#include &lt;netinet/ip.h&gt;</code><br/>
<code>#include &lt;netinet/ip6.h&gt;</code><br/>
<div class="dynheader">
Include dependency graph for p3session.h:</div>
<div class="dynsection">
</div>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
</div>

<p><a href="p3session_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3session.html">_p3session</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__p3route.html">_p3route</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a5e218cf082b038523f677bab9b0ff5ca">p3KTYPE_AES128</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a43e96f5ff430b56b883cc845f6c80aa1">p3KSIZE_AES128</a>&nbsp;&nbsp;&nbsp;(128 &gt;&gt; 3)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a7ebc574440c6e3bceb3310b0961a02cf">p3KTYPE_AES256</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#ae88a9f5adc845808aec753b6a2131843">p3KSIZE_AES256</a>&nbsp;&nbsp;&nbsp;(256 &gt;&gt; 3)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a7865bcf6503e04d9382352ce7ed762d0">p3STYPE_DATA</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a7637dca689aeb78a65ee26565104b8af">p3STYPE_CTL</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#abb2288f4e0941b2c95c5b25e5cb6adca">p3CMSG_KTYPE</a>&nbsp;&nbsp;&nbsp;0x0f</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a061808a57374df904b2186e5f454ea0b">p3CMSG_SET_KEY_ARRAY</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a51cf502b86b9c685a1375c180ab87d6b">p3CMSG_ACK_KEY_ARRAY</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a60effa9bb3acb2f6ef9175c8ff5fa422">p3CMSG_AKKERR</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a2bbf1f59b4aa3cc6fbab2efb27c8e5b5">p3CMSG_AKDERR</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a94d6c480ed9c43a278a83e53d4101fa2">p3CMSG_AKERR</a>&nbsp;&nbsp;&nbsp;(p3CMSG_AKKERR | p3CMSG_AKDERR)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#ae115d3fa059167950439b75e643f6078">p3CMSG_REPLACE_KEY</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#ad61c7c51aded08bbac13307cc51b465d">p3CMSG_KRDIDX</a>&nbsp;&nbsp;&nbsp;0x10</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#acd2e35cea676bb2909d9509768a44146">p3CMSG_KRCIDX</a>&nbsp;&nbsp;&nbsp;0x20</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#aef9a285d8e3f1f7c90b8c74505353584">p3CMSG_KRXMIT</a>&nbsp;&nbsp;&nbsp;0x40</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a7fe5f2a9307cc1160ec7a78e1ca1b020">p3CMSG_KEY_STATUS</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a8cd0cb0e2a3ef849783f6b5c543bdd9c">p3CMSG_KSCKERR</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a1cd84fa8de6ffede96ad8e4c7544c011">p3CMSG_KSCIERR</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#aee27056e708ed370046968cbb21a43d1">p3CMSG_KSDKERR</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a18b5e444f3638fa23d7c32f2466fd3e0">p3CMSG_KSDIERR</a>&nbsp;&nbsp;&nbsp;0x08</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a5ddbb26579af7bc92588daadd73e070b">p3CMSG_KSERR</a>&nbsp;&nbsp;&nbsp;(p3CMSG_KSCKERR | p3CMSG_KSCIERR | p3CMSG_KSDKERR | p3CMSG_KSDIERR)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a2e133285694777e39e31760f8a2b6fcd">p3CMSG_REKEY</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#ac748fd7feb032391afebc731f790f56a">p3CMSG_REKEY_TEST</a>&nbsp;&nbsp;&nbsp;6</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a398e02376281a1b3cd8208fe1b17ad4f">p3CMSG_HRTBEAT_QUERY</a>&nbsp;&nbsp;&nbsp;7</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#adfa37ed42ccf906c7a788f3f2bb03826">p3CMSG_HRTBEAT_ANSWER</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a543f5ec4a1b0b7f0549bc413f73b5586">p3CMSG_STATUS_REQ</a>&nbsp;&nbsp;&nbsp;9</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a8e31244e34ae5708962bf3712b830266">p3CMSG_STATUS_RESP</a>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a8de27e6fe7405f092bbd2c3a90c37cfb">p3CMSG_UPDATE_INFO</a>&nbsp;&nbsp;&nbsp;11</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a03d965ba32775ac2f7c97fbab42ded2a">p3CMSG_UICODE</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a6b3609778ab6fbc6ab688c6af4f79356">p3CMSG_UICFG</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a3f75c6ea278157b0eb0993d747f53df6">p3CMSG_ACK_UPDATE</a>&nbsp;&nbsp;&nbsp;12</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a62797f64bcb93703748196db607fadde">p3CMSG_AUDERR</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a082def1cf239e3d9b45d1860d55cd099">p3CMSG_AUUERR</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a5881c3270ca66214f0b6075dd954d489">p3CMSG_AUERR</a>&nbsp;&nbsp;&nbsp;(p3CMSG_AUDERR | p3CMSG_AUUERR)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a9e94ca9b2829d819d4496f75bc3fcdbd">p3CMSG_SHUTDOWN</a>&nbsp;&nbsp;&nbsp;13</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#ae842f02f8e3475ad06ae167f37e74b8f">p3CMSG_SHRIMM</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a1ff1b2efb3799c797e0dc2f873f60dc6">p3CMSG_SHRTIME</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a177f13de6abc0656f1ee447cb2cda956">p3CMSG_ACK_SHUTDOWN</a>&nbsp;&nbsp;&nbsp;14</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a37d2936f2f3ec2617bd3dffd0d9e375a">p3CMSG_ASACK</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a03fa4c2654e9150c5fb68fe5a515a0d2">p3PSS_FLG1</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a9b0af3f0fa50525318f1d3b3b5d3c5c3">p3RT_IPv4</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__p3session.html">_p3session</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a9b6cd103bb13010761e047886b00a731">p3session</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__p3route.html">_p3route</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a461272c2dc749c8d1083390d51e9d617">p3route</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct _p3ctlmsg&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a9e91c012ed0c808ee4066a8009b65b3d">p3ctlmsg</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#ab9736b0cd8825c593ed38263618b322c">send_ctl_message</a> (int type, unsigned char *message, int len, <a class="el" href="struct__p3session.html">p3session</a> *<a class="el" href="p3session_8h.html#af01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a143d81d2c62956d2455749a1142384ea">recv_ctl_message</a> (unsigned char *message)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#abc20c06498d8811c5b97a277ff975b22">set_key_array</a> (unsigned char *karray, int ksize, int dsize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#aa29843c992af9152b3333c6c3671f64e">key_array_error</a> (int flag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a5e7b0c0c7c098b369f449889ed766666">replace_key_index</a> (int type, int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a49abb8496f26018e75b7048dfb9ac28e">replace_key</a> (int type, unsigned char *key, int klen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a448bf68cd4df6a6a00aae61258626e87">replace_key_error</a> (int flag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a10a2b6f7e24a47f459c7cd89d09a2690">rekey_test_pri</a> (unsigned char *message, int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a12cfa395e96beaa00e49b7712ca1a29b">rekey_test_sec</a> (unsigned char *message, int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a836f2a2f279e6a21152ef0baeb58e674">rekey_session</a> (unsigned int key_num)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a9d7e3e02a08fef64db8d03098e5b0872">heartbeat_query</a> (int sec, int subsec, unsigned int seqnum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#a10173529f2458f4e948cf79016dffe6f">heartbeat_answer</a> (int sec, int subsec, unsigned int seqnum)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3session_8h.html#af01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h3>Protected Point to Point primary user interface header file</h3>
<p>Copyright (C) Velocite 2010 </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a5e218cf082b038523f677bab9b0ff5ca"></a><!-- doxytag: member="p3session.h::p3KTYPE_AES128" ref="a5e218cf082b038523f677bab9b0ff5ca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KTYPE_AES128&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a43e96f5ff430b56b883cc845f6c80aa1"></a><!-- doxytag: member="p3session.h::p3KSIZE_AES128" ref="a43e96f5ff430b56b883cc845f6c80aa1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KSIZE_AES128&nbsp;&nbsp;&nbsp;(128 &gt;&gt; 3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a7ebc574440c6e3bceb3310b0961a02cf"></a><!-- doxytag: member="p3session.h::p3KTYPE_AES256" ref="a7ebc574440c6e3bceb3310b0961a02cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KTYPE_AES256&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="ae88a9f5adc845808aec753b6a2131843"></a><!-- doxytag: member="p3session.h::p3KSIZE_AES256" ref="ae88a9f5adc845808aec753b6a2131843" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3KSIZE_AES256&nbsp;&nbsp;&nbsp;(256 &gt;&gt; 3)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a7865bcf6503e04d9382352ce7ed762d0"></a><!-- doxytag: member="p3session.h::p3STYPE_DATA" ref="a7865bcf6503e04d9382352ce7ed762d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3STYPE_DATA&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a7637dca689aeb78a65ee26565104b8af"></a><!-- doxytag: member="p3session.h::p3STYPE_CTL" ref="a7637dca689aeb78a65ee26565104b8af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3STYPE_CTL&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="abb2288f4e0941b2c95c5b25e5cb6adca"></a><!-- doxytag: member="p3session.h::p3CMSG_KTYPE" ref="abb2288f4e0941b2c95c5b25e5cb6adca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KTYPE&nbsp;&nbsp;&nbsp;0x0f</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a061808a57374df904b2186e5f454ea0b"></a><!-- doxytag: member="p3session.h::p3CMSG_SET_KEY_ARRAY" ref="a061808a57374df904b2186e5f454ea0b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SET_KEY_ARRAY&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a51cf502b86b9c685a1375c180ab87d6b"></a><!-- doxytag: member="p3session.h::p3CMSG_ACK_KEY_ARRAY" ref="a51cf502b86b9c685a1375c180ab87d6b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ACK_KEY_ARRAY&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a60effa9bb3acb2f6ef9175c8ff5fa422"></a><!-- doxytag: member="p3session.h::p3CMSG_AKKERR" ref="a60effa9bb3acb2f6ef9175c8ff5fa422" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AKKERR&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2bbf1f59b4aa3cc6fbab2efb27c8e5b5"></a><!-- doxytag: member="p3session.h::p3CMSG_AKDERR" ref="a2bbf1f59b4aa3cc6fbab2efb27c8e5b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AKDERR&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a94d6c480ed9c43a278a83e53d4101fa2"></a><!-- doxytag: member="p3session.h::p3CMSG_AKERR" ref="a94d6c480ed9c43a278a83e53d4101fa2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AKERR&nbsp;&nbsp;&nbsp;(p3CMSG_AKKERR | p3CMSG_AKDERR)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="ae115d3fa059167950439b75e643f6078"></a><!-- doxytag: member="p3session.h::p3CMSG_REPLACE_KEY" ref="ae115d3fa059167950439b75e643f6078" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_REPLACE_KEY&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="ad61c7c51aded08bbac13307cc51b465d"></a><!-- doxytag: member="p3session.h::p3CMSG_KRDIDX" ref="ad61c7c51aded08bbac13307cc51b465d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KRDIDX&nbsp;&nbsp;&nbsp;0x10</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="acd2e35cea676bb2909d9509768a44146"></a><!-- doxytag: member="p3session.h::p3CMSG_KRCIDX" ref="acd2e35cea676bb2909d9509768a44146" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KRCIDX&nbsp;&nbsp;&nbsp;0x20</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="aef9a285d8e3f1f7c90b8c74505353584"></a><!-- doxytag: member="p3session.h::p3CMSG_KRXMIT" ref="aef9a285d8e3f1f7c90b8c74505353584" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KRXMIT&nbsp;&nbsp;&nbsp;0x40</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7fe5f2a9307cc1160ec7a78e1ca1b020"></a><!-- doxytag: member="p3session.h::p3CMSG_KEY_STATUS" ref="a7fe5f2a9307cc1160ec7a78e1ca1b020" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KEY_STATUS&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a8cd0cb0e2a3ef849783f6b5c543bdd9c"></a><!-- doxytag: member="p3session.h::p3CMSG_KSCKERR" ref="a8cd0cb0e2a3ef849783f6b5c543bdd9c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KSCKERR&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1cd84fa8de6ffede96ad8e4c7544c011"></a><!-- doxytag: member="p3session.h::p3CMSG_KSCIERR" ref="a1cd84fa8de6ffede96ad8e4c7544c011" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KSCIERR&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aee27056e708ed370046968cbb21a43d1"></a><!-- doxytag: member="p3session.h::p3CMSG_KSDKERR" ref="aee27056e708ed370046968cbb21a43d1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KSDKERR&nbsp;&nbsp;&nbsp;0x04</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a18b5e444f3638fa23d7c32f2466fd3e0"></a><!-- doxytag: member="p3session.h::p3CMSG_KSDIERR" ref="a18b5e444f3638fa23d7c32f2466fd3e0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KSDIERR&nbsp;&nbsp;&nbsp;0x08</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5ddbb26579af7bc92588daadd73e070b"></a><!-- doxytag: member="p3session.h::p3CMSG_KSERR" ref="a5ddbb26579af7bc92588daadd73e070b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_KSERR&nbsp;&nbsp;&nbsp;(p3CMSG_KSCKERR | p3CMSG_KSCIERR | p3CMSG_KSDKERR | p3CMSG_KSDIERR)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a2e133285694777e39e31760f8a2b6fcd"></a><!-- doxytag: member="p3session.h::p3CMSG_REKEY" ref="a2e133285694777e39e31760f8a2b6fcd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_REKEY&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="ac748fd7feb032391afebc731f790f56a"></a><!-- doxytag: member="p3session.h::p3CMSG_REKEY_TEST" ref="ac748fd7feb032391afebc731f790f56a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_REKEY_TEST&nbsp;&nbsp;&nbsp;6</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a398e02376281a1b3cd8208fe1b17ad4f"></a><!-- doxytag: member="p3session.h::p3CMSG_HRTBEAT_QUERY" ref="a398e02376281a1b3cd8208fe1b17ad4f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_HRTBEAT_QUERY&nbsp;&nbsp;&nbsp;7</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="adfa37ed42ccf906c7a788f3f2bb03826"></a><!-- doxytag: member="p3session.h::p3CMSG_HRTBEAT_ANSWER" ref="adfa37ed42ccf906c7a788f3f2bb03826" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_HRTBEAT_ANSWER&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a543f5ec4a1b0b7f0549bc413f73b5586"></a><!-- doxytag: member="p3session.h::p3CMSG_STATUS_REQ" ref="a543f5ec4a1b0b7f0549bc413f73b5586" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_STATUS_REQ&nbsp;&nbsp;&nbsp;9</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a8e31244e34ae5708962bf3712b830266"></a><!-- doxytag: member="p3session.h::p3CMSG_STATUS_RESP" ref="a8e31244e34ae5708962bf3712b830266" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_STATUS_RESP&nbsp;&nbsp;&nbsp;10</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a8de27e6fe7405f092bbd2c3a90c37cfb"></a><!-- doxytag: member="p3session.h::p3CMSG_UPDATE_INFO" ref="a8de27e6fe7405f092bbd2c3a90c37cfb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_UPDATE_INFO&nbsp;&nbsp;&nbsp;11</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a03d965ba32775ac2f7c97fbab42ded2a"></a><!-- doxytag: member="p3session.h::p3CMSG_UICODE" ref="a03d965ba32775ac2f7c97fbab42ded2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_UICODE&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6b3609778ab6fbc6ab688c6af4f79356"></a><!-- doxytag: member="p3session.h::p3CMSG_UICFG" ref="a6b3609778ab6fbc6ab688c6af4f79356" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_UICFG&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3f75c6ea278157b0eb0993d747f53df6"></a><!-- doxytag: member="p3session.h::p3CMSG_ACK_UPDATE" ref="a3f75c6ea278157b0eb0993d747f53df6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ACK_UPDATE&nbsp;&nbsp;&nbsp;12</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a62797f64bcb93703748196db607fadde"></a><!-- doxytag: member="p3session.h::p3CMSG_AUDERR" ref="a62797f64bcb93703748196db607fadde" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AUDERR&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a082def1cf239e3d9b45d1860d55cd099"></a><!-- doxytag: member="p3session.h::p3CMSG_AUUERR" ref="a082def1cf239e3d9b45d1860d55cd099" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AUUERR&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5881c3270ca66214f0b6075dd954d489"></a><!-- doxytag: member="p3session.h::p3CMSG_AUERR" ref="a5881c3270ca66214f0b6075dd954d489" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_AUERR&nbsp;&nbsp;&nbsp;(p3CMSG_AUDERR | p3CMSG_AUUERR)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9e94ca9b2829d819d4496f75bc3fcdbd"></a><!-- doxytag: member="p3session.h::p3CMSG_SHUTDOWN" ref="a9e94ca9b2829d819d4496f75bc3fcdbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SHUTDOWN&nbsp;&nbsp;&nbsp;13</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="ae842f02f8e3475ad06ae167f37e74b8f"></a><!-- doxytag: member="p3session.h::p3CMSG_SHRIMM" ref="ae842f02f8e3475ad06ae167f37e74b8f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SHRIMM&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1ff1b2efb3799c797e0dc2f873f60dc6"></a><!-- doxytag: member="p3session.h::p3CMSG_SHRTIME" ref="a1ff1b2efb3799c797e0dc2f873f60dc6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_SHRTIME&nbsp;&nbsp;&nbsp;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a177f13de6abc0656f1ee447cb2cda956"></a><!-- doxytag: member="p3session.h::p3CMSG_ACK_SHUTDOWN" ref="a177f13de6abc0656f1ee447cb2cda956" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ACK_SHUTDOWN&nbsp;&nbsp;&nbsp;14</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a37d2936f2f3ec2617bd3dffd0d9e375a"></a><!-- doxytag: member="p3session.h::p3CMSG_ASACK" ref="a37d2936f2f3ec2617bd3dffd0d9e375a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3CMSG_ASACK&nbsp;&nbsp;&nbsp;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a03fa4c2654e9150c5fb68fe5a515a0d2"></a><!-- doxytag: member="p3session.h::p3PSS_FLG1" ref="a03fa4c2654e9150c5fb68fe5a515a0d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3PSS_FLG1&nbsp;&nbsp;&nbsp;0x00000001</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9b0af3f0fa50525318f1d3b3b5d3c5c3"></a><!-- doxytag: member="p3session.h::p3RT_IPv4" ref="a9b0af3f0fa50525318f1d3b3b5d3c5c3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define p3RT_IPv4&nbsp;&nbsp;&nbsp;0x00000001</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a9b6cd103bb13010761e047886b00a731"></a><!-- doxytag: member="p3session.h::p3session" ref="a9b6cd103bb13010761e047886b00a731" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3session.html">_p3session</a> <a class="el" href="struct__p3session.html">p3session</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a461272c2dc749c8d1083390d51e9d617"></a><!-- doxytag: member="p3session.h::p3route" ref="a461272c2dc749c8d1083390d51e9d617" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__p3route.html">_p3route</a> <a class="el" href="struct__p3route.html">p3route</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9e91c012ed0c808ee4066a8009b65b3d"></a><!-- doxytag: member="p3session.h::p3ctlmsg" ref="a9e91c012ed0c808ee4066a8009b65b3d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct _p3ctlmsg <a class="el" href="p3session_8h.html#a9e91c012ed0c808ee4066a8009b65b3d">p3ctlmsg</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab9736b0cd8825c593ed38263618b322c"></a><!-- doxytag: member="p3session.h::send_ctl_message" ref="ab9736b0cd8825c593ed38263618b322c" args="(int type, unsigned char *message, int len, p3session *p3sess)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_ctl_message </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__p3session.html">p3session</a> *&nbsp;</td>
          <td class="paramname"> <em>p3sess</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>send_ctl_message</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Manage the primary to secondary session.</dd></dl>
<p>NOTE: If implemented as a continuous child process, see sendmsg, recvmsg, and cmsg for passing socket file descriptors.</p>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>type: P3 control message type</li>
<li>message: Message data</li>
<li>len: Length of message data</li>
<li>sess: Session structure</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li>
<li>&lt;0 = Error </li>
</ul>
</li>
</ul>
</dd></dl>

<p>References <a class="el" href="p3session_8h_source.html#l00090">_p3session::ctlhdr</a>, <a class="el" href="p3session_8h_source.html#l00091">_p3session::hdrlen</a>, and <a class="el" href="p3base_8h_source.html#l00151">p3malloc</a>.</p>

</div>
</div>
<a class="anchor" id="a143d81d2c62956d2455749a1142384ea"></a><!-- doxytag: member="p3session.h::recv_ctl_message" ref="a143d81d2c62956d2455749a1142384ea" args="(unsigned char *message)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int recv_ctl_message </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>recv_ctl_message</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Parse a message and call the function to handle it. The format of the Control Messages is: <pre>
 | 4 octets | 1 octet | Variable length |
 | Size     | Command | Data            |
   where the fields are:
 Size:  The total size of the message, including the size field itself
 Command:  An 8-bit number
 Data:  The data, if any, associated with the command
 </pre></dd></dl>
<p>The handler functions must be defined in the primary or secondary session handler, depending on which receives the message. The message handling code is only compiled if the P3 system is the receiver. All message handling is compiled for the Primary Plus Secondary P3 system.</p>
<p>See the P3 System Specification for details on the commands.</p>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>message: The full message buffer including the size field.</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li>
<li>&lt;0 = Error</li>
<li>&gt;0 = Status from remote P3 system </li>
</ul>
</li>
</ul>
</dd></dl>

<p>References <a class="el" href="p3pri__session_8c_source.html#l00166">heartbeat_answer()</a>, <a class="el" href="p3sec__session_8c_source.html#l00249">heartbeat_query()</a>, <a class="el" href="p3pri__session_8c_source.html#l00096">key_array_error()</a>, <a class="el" href="p3session_8h_source.html#l00029">p3CMSG_ACK_KEY_ARRAY</a>, <a class="el" href="p3session_8h_source.html#l00062">p3CMSG_ACK_SHUTDOWN</a>, <a class="el" href="p3session_8h_source.html#l00054">p3CMSG_ACK_UPDATE</a>, <a class="el" href="p3session_8h_source.html#l00032">p3CMSG_AKERR</a>, <a class="el" href="p3session_8h_source.html#l00048">p3CMSG_HRTBEAT_ANSWER</a>, <a class="el" href="p3session_8h_source.html#l00047">p3CMSG_HRTBEAT_QUERY</a>, <a class="el" href="p3session_8h_source.html#l00038">p3CMSG_KEY_STATUS</a>, <a class="el" href="p3session_8h_source.html#l00036">p3CMSG_KRCIDX</a>, <a class="el" href="p3session_8h_source.html#l00035">p3CMSG_KRDIDX</a>, <a class="el" href="p3session_8h_source.html#l00043">p3CMSG_KSERR</a>, <a class="el" href="p3session_8h_source.html#l00027">p3CMSG_KTYPE</a>, <a class="el" href="p3session_8h_source.html#l00045">p3CMSG_REKEY</a>, <a class="el" href="p3session_8h_source.html#l00046">p3CMSG_REKEY_TEST</a>, <a class="el" href="p3session_8h_source.html#l00034">p3CMSG_REPLACE_KEY</a>, <a class="el" href="p3session_8h_source.html#l00028">p3CMSG_SET_KEY_ARRAY</a>, <a class="el" href="p3session_8h_source.html#l00059">p3CMSG_SHUTDOWN</a>, <a class="el" href="p3session_8h_source.html#l00049">p3CMSG_STATUS_REQ</a>, <a class="el" href="p3session_8h_source.html#l00050">p3CMSG_STATUS_RESP</a>, <a class="el" href="p3session_8h_source.html#l00051">p3CMSG_UPDATE_INFO</a>, <a class="el" href="p3session_8h_source.html#l00021">p3KSIZE_AES128</a>, <a class="el" href="p3session_8h_source.html#l00023">p3KSIZE_AES256</a>, <a class="el" href="p3session_8h_source.html#l00020">p3KTYPE_AES128</a>, <a class="el" href="p3session_8h_source.html#l00022">p3KTYPE_AES256</a>, <a class="el" href="p3session_8h_source.html#l00025">p3STYPE_CTL</a>, <a class="el" href="p3session_8h_source.html#l00024">p3STYPE_DATA</a>, <a class="el" href="p3sec__session_8c_source.html#l00196">rekey_session()</a>, <a class="el" href="p3pri__session_8c_source.html#l00141">rekey_test_pri()</a>, <a class="el" href="p3sec__session_8c_source.html#l00222">rekey_test_sec()</a>, <a class="el" href="p3sec__session_8c_source.html#l00173">replace_key()</a>, <a class="el" href="p3pri__session_8c_source.html#l00116">replace_key_error()</a>, <a class="el" href="p3sec__session_8c_source.html#l00146">replace_key_index()</a>, and <a class="el" href="p3sec__session_8c_source.html#l00121">set_key_array()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="abc20c06498d8811c5b97a277ff975b22"></a><!-- doxytag: member="p3session.h::set_key_array" ref="abc20c06498d8811c5b97a277ff975b22" args="(unsigned char *karray, int ksize, int dsize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_key_array </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>karray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>dsize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>set_key_array</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Receive an array of keys from the primary. The secondary stores these in an array for when an index is used to indicate the key replacement.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>None</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status (see the errors for the p3CMSG_ACK_KEY_ARRAY field) </li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="aa29843c992af9152b3333c6c3671f64e"></a><!-- doxytag: member="p3session.h::key_array_error" ref="aa29843c992af9152b3333c6c3671f64e" args="(int flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void key_array_error </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>key_array_error</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Handle a key array error message from the secondary session.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>flag: Indicates the specific error</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>None </li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a5e7b0c0c7c098b369f449889ed766666"></a><!-- doxytag: member="p3session.h::replace_key_index" ref="a5e7b0c0c7c098b369f449889ed766666" args="(int type, int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int replace_key_index </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>replace_key_index</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Replace a key using an index into the key array.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>type: The type of key to be replaced:<ul>
<li>Data</li>
<li>Control</li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status (see the errors for the p3CMSG_KEY_STATUS field) </li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a49abb8496f26018e75b7048dfb9ac28e"></a><!-- doxytag: member="p3session.h::replace_key" ref="a49abb8496f26018e75b7048dfb9ac28e" args="(int type, unsigned char *key, int klen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int replace_key </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>klen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>replace_key</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Replace a key from the primary using the key sent in the message.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>type: The type of key to be replaced:<ul>
<li>Data</li>
<li>Control</li>
</ul>
</li>
<li>key: The key contained in the message</li>
<li>klen: The length of the key</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status (see the errors for the p3CMSG_KEY_STATUS field) </li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a448bf68cd4df6a6a00aae61258626e87"></a><!-- doxytag: member="p3session.h::replace_key_error" ref="a448bf68cd4df6a6a00aae61258626e87" args="(int flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void replace_key_error </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>flag</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>replace_key_error</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Handle a key array error message from the secondary session.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>flag: Indicates the specific error</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>None </li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a10a2b6f7e24a47f459c7cd89d09a2690"></a><!-- doxytag: member="p3session.h::rekey_test_pri" ref="a10a2b6f7e24a47f459c7cd89d09a2690" args="(unsigned char *message, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rekey_test_pri </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>rekey_test_pri</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Receive a message from a secondary, reverse it and compare it to the original test message.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>message: The message from the secondary</li>
<li>size: The size of the message</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li>
<li>&lt;0 = Error </li>
</ul>
</li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a12cfa395e96beaa00e49b7712ca1a29b"></a><!-- doxytag: member="p3session.h::rekey_test_sec" ref="a12cfa395e96beaa00e49b7712ca1a29b" args="(unsigned char *message, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rekey_test_sec </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>rekey_test_sec</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Receive a message from the primary, reverse it and resend it.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>message: The message from the primary</li>
<li>size: The size of the message</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li>
<li>&lt;0 = Error </li>
</ul>
</li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a836f2a2f279e6a21152ef0baeb58e674"></a><!-- doxytag: member="p3session.h::rekey_session" ref="a836f2a2f279e6a21152ef0baeb58e674" args="(unsigned int key_num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rekey_session </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>key_num</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>rekey_session</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Start using a replacement key from the primary.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>key_num: The packet ID of the first packet to use the new key</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>None </li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d7e3e02a08fef64db8d03098e5b0872"></a><!-- doxytag: member="p3session.h::heartbeat_query" ref="a9d7e3e02a08fef64db8d03098e5b0872" args="(int sec, int subsec, unsigned int seqnum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int heartbeat_query </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>subsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>seqnum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>heartbeat_query</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Handle a heartbeat query message from a primary.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>sec: The number of seconds after midnight the message was sent</li>
<li>subsec: The sub second time the message was sent</li>
<li>seqnum: The sequence number of the query</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>int: Status<ul>
<li>0 = OK</li>
<li>&lt;0 = Error </li>
</ul>
</li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<a class="anchor" id="a10173529f2458f4e948cf79016dffe6f"></a><!-- doxytag: member="p3session.h::heartbeat_answer" ref="a10173529f2458f4e948cf79016dffe6f" args="(int sec, int subsec, unsigned int seqnum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void heartbeat_answer </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>subsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>seqnum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="user"><dt><b>Function:</b></dt><dd>heartbeat_answer</dd></dl>
<dl class="user"><dt><b>Description:</b></dt><dd>Handle a heartbeat answer message from a secondary.</dd></dl>
<dl class="user"><dt><b>Inputs:</b></dt><dd><ul>
<li>sec: The number of seconds after midnight the message was sent</li>
<li>subsec: The sub second time the message was sent</li>
<li>seqnum: The sequence number of the query</li>
</ul>
</dd></dl>
<dl class="user"><dt><b>Outputs:</b></dt><dd><ul>
<li>None </li>
</ul>
</dd></dl>

<p>Referenced by <a class="el" href="p3session_8c_source.html#l00103">recv_ctl_message()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="af01e1812f2bb3a71e6bdf3a19a4120f8"></a><!-- doxytag: member="p3session.h::p3sess" ref="af01e1812f2bb3a71e6bdf3a19a4120f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__p3session.html">p3session</a>* <a class="el" href="p3session_8h.html#af01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Global variable usage </p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 1 13:24:48 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
