<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Velocite Systems Protected Point to Point Solution: p3session.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>p3session.h</h1><a href="p3session_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="preprocessor">#ifndef _p3SESSION_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#define _p3SESSION_H</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="comment">/*****  INCLUDE FILES *****/</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="p3base_8h.html">p3base.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="p3crypto_8h.html">p3crypto.h</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;netinet/ip.h&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;netinet/ip6.h&gt;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">/*****  CONSTANTS  *****/</span>
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="p3session_8h.html#a5e218cf082b038523f677bab9b0ff5ca">00020</a> <span class="preprocessor">#define p3KTYPE_AES128  1</span>
<a name="l00021"></a><a class="code" href="p3session_8h.html#a43e96f5ff430b56b883cc845f6c80aa1">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define p3KSIZE_AES128  (128 &gt;&gt; 3)</span>
<a name="l00022"></a><a class="code" href="p3session_8h.html#a7ebc574440c6e3bceb3310b0961a02cf">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define p3KTYPE_AES256  2</span>
<a name="l00023"></a><a class="code" href="p3session_8h.html#ae88a9f5adc845808aec753b6a2131843">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define p3KSIZE_AES256  (256 &gt;&gt; 3)</span>
<a name="l00024"></a><a class="code" href="p3session_8h.html#a7865bcf6503e04d9382352ce7ed762d0">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define p3STYPE_DATA    1</span>
<a name="l00025"></a><a class="code" href="p3session_8h.html#a7637dca689aeb78a65ee26565104b8af">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define p3STYPE_CTL     2</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a><a class="code" href="p3session_8h.html#abb2288f4e0941b2c95c5b25e5cb6adca">00027</a> <span class="preprocessor">#define p3CMSG_KTYPE            0x0f    </span><span class="comment">/* Key type field */</span>
<a name="l00028"></a><a class="code" href="p3session_8h.html#a061808a57374df904b2186e5f454ea0b">00028</a> <span class="preprocessor">#define p3CMSG_SET_KEY_ARRAY    1</span>
<a name="l00029"></a><a class="code" href="p3session_8h.html#a51cf502b86b9c685a1375c180ab87d6b">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_ACK_KEY_ARRAY    2</span>
<a name="l00030"></a><a class="code" href="p3session_8h.html#a60effa9bb3acb2f6ef9175c8ff5fa422">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_AKKERR           0x01    </span><span class="comment">/* ACK_KEY_ARRAY Key error */</span>
<a name="l00031"></a><a class="code" href="p3session_8h.html#a2bbf1f59b4aa3cc6fbab2efb27c8e5b5">00031</a> <span class="preprocessor">#define p3CMSG_AKDERR           0x02    </span><span class="comment">/* ACK_KEY_ARRAY Data error */</span>
<a name="l00032"></a><a class="code" href="p3session_8h.html#a94d6c480ed9c43a278a83e53d4101fa2">00032</a> <span class="preprocessor">#define p3CMSG_AKERR \</span>
<a name="l00033"></a>00033 <span class="preprocessor">    (p3CMSG_AKKERR | p3CMSG_AKDERR)</span>
<a name="l00034"></a><a class="code" href="p3session_8h.html#ae115d3fa059167950439b75e643f6078">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_REPLACE_KEY      3</span>
<a name="l00035"></a><a class="code" href="p3session_8h.html#ad61c7c51aded08bbac13307cc51b465d">00035</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_KRDIDX           0x10    </span><span class="comment">/* REPLACE_KEY Control index */</span>
<a name="l00036"></a><a class="code" href="p3session_8h.html#acd2e35cea676bb2909d9509768a44146">00036</a> <span class="preprocessor">#define p3CMSG_KRCIDX           0x20    </span><span class="comment">/* REPLACE_KEY Data index */</span>
<a name="l00037"></a><a class="code" href="p3session_8h.html#aef9a285d8e3f1f7c90b8c74505353584">00037</a> <span class="preprocessor">#define p3CMSG_KRXMIT           0x40    </span><span class="comment">/* REPLACE_KEY Retransmit */</span>
<a name="l00038"></a><a class="code" href="p3session_8h.html#a7fe5f2a9307cc1160ec7a78e1ca1b020">00038</a> <span class="preprocessor">#define p3CMSG_KEY_STATUS       4</span>
<a name="l00039"></a><a class="code" href="p3session_8h.html#a8cd0cb0e2a3ef849783f6b5c543bdd9c">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_KSCKERR          0x01    </span><span class="comment">/* KEY_STATUS Control key error */</span>
<a name="l00040"></a><a class="code" href="p3session_8h.html#a1cd84fa8de6ffede96ad8e4c7544c011">00040</a> <span class="preprocessor">#define p3CMSG_KSCIERR          0x02    </span><span class="comment">/* KEY_STATUS Control key index error */</span>
<a name="l00041"></a><a class="code" href="p3session_8h.html#aee27056e708ed370046968cbb21a43d1">00041</a> <span class="preprocessor">#define p3CMSG_KSDKERR          0x04    </span><span class="comment">/* KEY_STATUS Data key error */</span>
<a name="l00042"></a><a class="code" href="p3session_8h.html#a18b5e444f3638fa23d7c32f2466fd3e0">00042</a> <span class="preprocessor">#define p3CMSG_KSDIERR          0x08    </span><span class="comment">/* KEY_STATUS Data key index error */</span>
<a name="l00043"></a><a class="code" href="p3session_8h.html#a5ddbb26579af7bc92588daadd73e070b">00043</a> <span class="preprocessor">#define p3CMSG_KSERR \</span>
<a name="l00044"></a>00044 <span class="preprocessor">    (p3CMSG_KSCKERR | p3CMSG_KSCIERR | p3CMSG_KSDKERR | p3CMSG_KSDIERR)</span>
<a name="l00045"></a><a class="code" href="p3session_8h.html#a2e133285694777e39e31760f8a2b6fcd">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_REKEY            5</span>
<a name="l00046"></a><a class="code" href="p3session_8h.html#ac748fd7feb032391afebc731f790f56a">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_REKEY_TEST       6</span>
<a name="l00047"></a><a class="code" href="p3session_8h.html#a398e02376281a1b3cd8208fe1b17ad4f">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_HRTBEAT_QUERY    7</span>
<a name="l00048"></a><a class="code" href="p3session_8h.html#adfa37ed42ccf906c7a788f3f2bb03826">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_HRTBEAT_ANSWER   8</span>
<a name="l00049"></a><a class="code" href="p3session_8h.html#a543f5ec4a1b0b7f0549bc413f73b5586">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_STATUS_REQ       9</span>
<a name="l00050"></a><a class="code" href="p3session_8h.html#a8e31244e34ae5708962bf3712b830266">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_STATUS_RESP      10</span>
<a name="l00051"></a><a class="code" href="p3session_8h.html#a8de27e6fe7405f092bbd2c3a90c37cfb">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_UPDATE_INFO      11</span>
<a name="l00052"></a><a class="code" href="p3session_8h.html#a03d965ba32775ac2f7c97fbab42ded2a">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_UICODE           0x01    </span><span class="comment">/* UPDATE_INFO Code update */</span>
<a name="l00053"></a><a class="code" href="p3session_8h.html#a6b3609778ab6fbc6ab688c6af4f79356">00053</a> <span class="preprocessor">#define p3CMSG_UICFG            0x02    </span><span class="comment">/* UPDATE_INFO Configuration update */</span>
<a name="l00054"></a><a class="code" href="p3session_8h.html#a3f75c6ea278157b0eb0993d747f53df6">00054</a> <span class="preprocessor">#define p3CMSG_ACK_UPDATE       12</span>
<a name="l00055"></a><a class="code" href="p3session_8h.html#a62797f64bcb93703748196db607fadde">00055</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_AUDERR           0x01    </span><span class="comment">/* ACK_UPDATE Update data error */</span>
<a name="l00056"></a><a class="code" href="p3session_8h.html#a082def1cf239e3d9b45d1860d55cd099">00056</a> <span class="preprocessor">#define p3CMSG_AUUERR           0x02    </span><span class="comment">/* ACK_UPDATE Update error */</span>
<a name="l00057"></a><a class="code" href="p3session_8h.html#a5881c3270ca66214f0b6075dd954d489">00057</a> <span class="preprocessor">#define p3CMSG_AUERR \</span>
<a name="l00058"></a>00058 <span class="preprocessor">    (p3CMSG_AUDERR | p3CMSG_AUUERR)</span>
<a name="l00059"></a><a class="code" href="p3session_8h.html#a9e94ca9b2829d819d4496f75bc3fcdbd">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_SHUTDOWN         13</span>
<a name="l00060"></a><a class="code" href="p3session_8h.html#ae842f02f8e3475ad06ae167f37e74b8f">00060</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_SHRIMM           0x01    </span><span class="comment">/* SHUTDOWN Restart immediately */</span>
<a name="l00061"></a><a class="code" href="p3session_8h.html#a1ff1b2efb3799c797e0dc2f873f60dc6">00061</a> <span class="preprocessor">#define p3CMSG_SHRTIME          0x02    </span><span class="comment">/* SHUTDOWN Restart after timeout */</span>
<a name="l00062"></a><a class="code" href="p3session_8h.html#a177f13de6abc0656f1ee447cb2cda956">00062</a> <span class="preprocessor">#define p3CMSG_ACK_SHUTDOWN     14</span>
<a name="l00063"></a><a class="code" href="p3session_8h.html#a37d2936f2f3ec2617bd3dffd0d9e375a">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define p3CMSG_ASACK            0x01    </span><span class="comment">/* ACK_SHUTDOWN Shutdown ACK */</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">/*****  DATA DEFINITIONS  *****/</span>
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="p3session_8h.html#a9b6cd103bb13010761e047886b00a731">00067</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__p3session.html">_p3session</a> <a class="code" href="struct__p3session.html">p3session</a>;
<a name="l00068"></a><a class="code" href="p3session_8h.html#a461272c2dc749c8d1083390d51e9d617">00068</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__p3route.html">_p3route</a> <a class="code" href="struct__p3route.html">p3route</a>;
<a name="l00069"></a><a class="code" href="p3session_8h.html#a9e91c012ed0c808ee4066a8009b65b3d">00069</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>_p3ctlmsg <a class="code" href="p3session_8h.html#a9e91c012ed0c808ee4066a8009b65b3d">p3ctlmsg</a>;
<a name="l00070"></a>00070 
<a name="l00079"></a><a class="code" href="struct__p3session.html">00079</a> <span class="keyword">struct </span><a class="code" href="struct__p3session.html">_p3session</a> {
<a name="l00080"></a><a class="code" href="struct__p3session.html#a04a0e6682c5b7257b519f13647d5fa44">00080</a>     <a class="code" href="struct__p3key.html">p3key</a>           *<a class="code" href="struct__p3session.html#a04a0e6682c5b7257b519f13647d5fa44">datkey0</a>;   <span class="comment">/*&lt;&lt; Data key 0 */</span>
<a name="l00081"></a><a class="code" href="struct__p3session.html#aba67ab15acb3069f7914f870ea30c0af">00081</a>     <a class="code" href="struct__p3key.html">p3key</a>           *<a class="code" href="struct__p3session.html#aba67ab15acb3069f7914f870ea30c0af">datkey1</a>;   <span class="comment">/*&lt;&lt; Data key 1 */</span>
<a name="l00082"></a><a class="code" href="struct__p3session.html#a36ff4dedb6c213b6f93839808d116174">00082</a>     <a class="code" href="struct__p3key.html">p3key</a>           *<a class="code" href="struct__p3session.html#a36ff4dedb6c213b6f93839808d116174">ctlkey0</a>;   <span class="comment">/*&lt;&lt; Control key 0 */</span>
<a name="l00083"></a><a class="code" href="struct__p3session.html#a92a41dc8e5927bf980d0f5cc67b9ccd6">00083</a>     <a class="code" href="struct__p3key.html">p3key</a>           *<a class="code" href="struct__p3session.html#a92a41dc8e5927bf980d0f5cc67b9ccd6">ctlkey1</a>;   <span class="comment">/*&lt;&lt; Control key 1 */</span>
<a name="l00084"></a><a class="code" href="struct__p3session.html#adfac5831c675f14295a25eec01531eab">00084</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="struct__p3session.html#adfac5831c675f14295a25eec01531eab">id0</a>;        <span class="comment">/*&lt;&lt; Key ID for key 0 */</span>
<a name="l00085"></a><a class="code" href="struct__p3session.html#af2b909bd4a6ace41af90365989efac3f">00085</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="struct__p3session.html#af2b909bd4a6ace41af90365989efac3f">id1</a>;        <span class="comment">/*&lt;&lt; Key ID for key 1 */</span>
<a name="l00086"></a>00086     <span class="keyword">union </span>{
<a name="l00087"></a><a class="code" href="struct__p3session.html#a8e2aa90db8e07026d735a8aa84c3b9e1">00087</a>         <span class="keyword">struct </span>in_addr  <a class="code" href="struct__p3session.html#a8e2aa90db8e07026d735a8aa84c3b9e1">v4</a>;
<a name="l00088"></a><a class="code" href="struct__p3session.html#afa0313159a0111b3ec50e86cdc61f768">00088</a>         <span class="keyword">struct </span>in6_addr <a class="code" href="struct__p3session.html#afa0313159a0111b3ec50e86cdc61f768">v6</a>;
<a name="l00089"></a>00089     } <a class="code" href="struct__p3session.html#a1f850dbbfec29f71a384e5f65ddee11f">addr</a>;                     <span class="comment">/*&lt;&lt; P3 host address (IPv4 or IPv6) */</span>
<a name="l00090"></a><a class="code" href="struct__p3session.html#a4b15be7ce593809b3e04c3f6c3aa6d16">00090</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   *<a class="code" href="struct__p3session.html#a4b15be7ce593809b3e04c3f6c3aa6d16">ctlhdr</a>;    <span class="comment">/*&lt;&lt; Control header */</span>
<a name="l00091"></a><a class="code" href="struct__p3session.html#a5f835a92e6cdbcb56112ff50e0dc1bf5">00091</a>     <span class="keywordtype">int</span>             <a class="code" href="struct__p3session.html#a5f835a92e6cdbcb56112ff50e0dc1bf5">hdrlen</a>;     <span class="comment">/*&lt;&lt; Length of control header */</span>
<a name="l00092"></a><a class="code" href="struct__p3session.html#a9fd7bb2d8c2819fa90fbc249ebdb150b">00092</a>     time_t          <a class="code" href="struct__p3session.html#a9fd7bb2d8c2819fa90fbc249ebdb150b">rekey</a>;      <span class="comment">/*&lt;&lt; Next time to rekey */</span>
<a name="l00093"></a><a class="code" href="struct__p3session.html#abc9ce94ece554ebda73862acdf66a987">00093</a>     <span class="keywordtype">int</span>             <a class="code" href="struct__p3session.html#abc9ce94ece554ebda73862acdf66a987">rk_wait</a>;    <span class="comment">/*&lt;&lt; Rekey period in seconds */</span>
<a name="l00094"></a><a class="code" href="struct__p3session.html#abe9d59bf1b985103be2f2093e3c84709">00094</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="struct__p3session.html#abe9d59bf1b985103be2f2093e3c84709">flag</a>;
<a name="l00095"></a><a class="code" href="p3session_8h.html#a03fa4c2654e9150c5fb68fe5a515a0d2">00095</a> <span class="preprocessor">#define p3PSS_FLG1  0x00000001</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span>};
<a name="l00097"></a>00097 
<a name="l00106"></a><a class="code" href="struct__p3route.html">00106</a> <span class="keyword">struct </span><a class="code" href="struct__p3route.html">_p3route</a> {
<a name="l00107"></a>00107     <span class="keyword">union </span>{
<a name="l00108"></a><a class="code" href="struct__p3route.html#ad3e0a6b4fa4e4ce9038cbeb54b4089ac">00108</a>         <span class="keyword">struct </span>in_addr  <a class="code" href="struct__p3route.html#ad3e0a6b4fa4e4ce9038cbeb54b4089ac">v4</a>;
<a name="l00109"></a><a class="code" href="struct__p3route.html#af4cced98f4fdd6b55ee4057f561d60b2">00109</a>         <span class="keyword">struct </span>in6_addr <a class="code" href="struct__p3route.html#af4cced98f4fdd6b55ee4057f561d60b2">v6</a>;
<a name="l00110"></a>00110     } <a class="code" href="struct__p3route.html#a2a998ac440bd405c0779ce8942980838">addr</a>;                     <span class="comment">/*&lt;&lt; Subnet address (IPv4 or IPv6) */</span>
<a name="l00111"></a>00111     <span class="keyword">union </span>{
<a name="l00112"></a>00112         <span class="keyword">struct </span>in_addr  <a class="code" href="struct__p3route.html#ad3e0a6b4fa4e4ce9038cbeb54b4089ac">v4</a>;
<a name="l00113"></a>00113         <span class="keyword">struct </span>in6_addr <a class="code" href="struct__p3route.html#af4cced98f4fdd6b55ee4057f561d60b2">v6</a>;
<a name="l00114"></a>00114     } <a class="code" href="struct__p3route.html#a2430cb7ae3f3eed2b54c70c481e904b6">mask</a>;                     <span class="comment">/*&lt;&lt; Subnet mask (IPv4) */</span>
<a name="l00115"></a><a class="code" href="struct__p3route.html#af76acb72108cb7242774018c4dcfb041">00115</a>     <a class="code" href="struct__p3session.html">p3session</a>       *<a class="code" href="struct__p3route.html#af76acb72108cb7242774018c4dcfb041">p3host</a>;    <span class="comment">/*&lt;&lt; Remote host entry for route (must be cast) */</span>
<a name="l00116"></a><a class="code" href="struct__p3route.html#ae973900f5f79195ad5b93a608f33bdb0">00116</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="struct__p3route.html#ae973900f5f79195ad5b93a608f33bdb0">flag</a>;
<a name="l00117"></a><a class="code" href="p3session_8h.html#a9b0af3f0fa50525318f1d3b3b5d3c5c3">00117</a> <span class="preprocessor">#define p3RT_IPv4   0x00000001  </span><span class="comment">/* Route is IPv4 */</span>
<a name="l00118"></a>00118 };
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="comment">/*****  MACROS  *****/</span>
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">/*****  PROTOTYPES  *****/</span>
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 <span class="preprocessor">#ifdef _p3PRI_SS_C</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="p3pri__session_8c.html#ad689780f8237273f13da2bb61d016145">init_pri_session</a>();
<a name="l00126"></a>00126 <span class="keywordtype">int</span> <a class="code" href="p3pri__session_8c.html#abed8a5190bb70efbc926027276ed28c9">pri_session_manager</a>();
<a name="l00127"></a>00127 <span class="preprocessor">#endif</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span><span class="preprocessor">#ifdef _p3SEC_SS_C</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#ad1fe2c10e0ea71c8714a626a46d60daf">init_sec_session</a>();
<a name="l00130"></a>00130 <span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#a552e186651a9de0f8cdc8104e71e8597">sec_session_manager</a>();
<a name="l00131"></a>00131 <span class="preprocessor">#endif</span>
<a name="l00132"></a>00132 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="p3session_8c.html#ab9736b0cd8825c593ed38263618b322c">send_ctl_message</a>(<span class="keywordtype">int</span> type, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *message, <span class="keywordtype">int</span> len, <a class="code" href="struct__p3session.html">p3session</a> *<a class="code" href="p3sec__session_8c.html#af01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>);
<a name="l00133"></a>00133 <span class="keywordtype">int</span> <a class="code" href="p3session_8c.html#a143d81d2c62956d2455749a1142384ea">recv_ctl_message</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *message);
<a name="l00134"></a>00134 <span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#a019a4d1e2c7fee5745409f77863afe94">set_key_array</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *karray, <span class="keywordtype">int</span> ksize, <span class="keywordtype">int</span> dsize);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="comment">/*****  EXTERNAL DEFINITIONS  *****/</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="preprocessor">#ifdef _p3_SECONDARY</span>
<a name="l00139"></a>00139 <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="struct__p3session.html">p3session</a> *<a class="code" href="p3sec__session_8c.html#af01e1812f2bb3a71e6bdf3a19a4120f8">p3sess</a>;
<a name="l00140"></a>00140 <span class="preprocessor">#endif</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#a019a4d1e2c7fee5745409f77863afe94">set_key_array</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *message, <span class="keywordtype">int</span> ksize, <span class="keywordtype">int</span> dsize);
<a name="l00142"></a>00142 <span class="keywordtype">void</span> <a class="code" href="p3pri__session_8c.html#aa29843c992af9152b3333c6c3671f64e">key_array_error</a>(<span class="keywordtype">int</span> flag);
<a name="l00143"></a>00143 <span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#a5e7b0c0c7c098b369f449889ed766666">replace_key_index</a>(<span class="keywordtype">int</span> type, <span class="keywordtype">int</span> index);
<a name="l00144"></a>00144 <span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#a49abb8496f26018e75b7048dfb9ac28e">replace_key</a>(<span class="keywordtype">int</span> type, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *key, <span class="keywordtype">int</span> klen);
<a name="l00145"></a>00145 <span class="keywordtype">void</span> <a class="code" href="p3pri__session_8c.html#a448bf68cd4df6a6a00aae61258626e87">replace_key_error</a>(<span class="keywordtype">int</span> flag);
<a name="l00146"></a>00146 <span class="keywordtype">int</span> <a class="code" href="p3pri__session_8c.html#a10a2b6f7e24a47f459c7cd89d09a2690">rekey_test_pri</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *message, <span class="keywordtype">int</span> size);
<a name="l00147"></a>00147 <span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#a12cfa395e96beaa00e49b7712ca1a29b">rekey_test_sec</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *message, <span class="keywordtype">int</span> size);
<a name="l00148"></a>00148 <span class="keywordtype">void</span> <a class="code" href="p3sec__session_8c.html#a836f2a2f279e6a21152ef0baeb58e674">rekey_session</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> key_num);
<a name="l00149"></a>00149 <span class="keywordtype">int</span> <a class="code" href="p3sec__session_8c.html#a9d7e3e02a08fef64db8d03098e5b0872">heartbeat_query</a>(<span class="keywordtype">int</span> sec, <span class="keywordtype">int</span> subsec, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seqnum);
<a name="l00150"></a>00150 <span class="keywordtype">void</span> <a class="code" href="p3pri__session_8c.html#a10173529f2458f4e948cf79016dffe6f">heartbeat_answer</a>(<span class="keywordtype">int</span> sec, <span class="keywordtype">int</span> subsec, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seqnum);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="preprocessor">#endif </span><span class="comment">/* _p3SESSION_H */</span>
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 1 13:24:47 2010 for Velocite Systems Protected Point to Point Solution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
